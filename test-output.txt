
> sysmcp-mcp-host@0.1.0 test
> jest

PASS src/mcp/__tests__/eventlog-mcp.test.ts
PASS src/services/eventlog/__tests__/types.test.ts
PASS src/mcp/__tests__/logging.test.ts
PASS src/mcp/__tests__/schema-validator.test.ts
PASS src/mcp/__tests__/service-manager.test.ts
PASS src/mcp/__tests__/error-handler.test.ts (5.054 s)
PASS src/services/eventlog/lib/src/__tests__/eventlog-adapter.test.ts (5.073 s)
FAIL src/services/eventlog/__tests__/metrics.test.ts (5.192 s)
  ΓùÅ EventLogMetricsCollector ΓÇ║ recordQuery ΓÇ║ should reject non-numeric duration

    expect(received).toThrow()

    Received function did not throw

      83 |
      84 |     it('should reject non-numeric duration', () => {
    > 85 |       expect(() => collector.recordQuery(NaN, 10)).toThrow();
         |                                                    ^
      86 |     });
      87 |
      88 |     it('should reject negative result count', () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:85:52)

  ΓùÅ EventLogMetricsCollector ΓÇ║ recordQuery ΓÇ║ should reject non-numeric result count

    expect(received).toThrow()

    Received function did not throw

      91 |
      92 |     it('should reject non-numeric result count', () => {
    > 93 |       expect(() => collector.recordQuery(100, NaN)).toThrow();
         |                                                     ^
      94 |     });
      95 |
      96 |     it('should handle zero results', () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:93:53)

  ΓùÅ EventLogMetricsCollector ΓÇ║ reset ΓÇ║ should reset uptime for export

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      228 |       const after = await collector.export();
      229 |
    > 230 |       expect(before.uptimeMs).toBeGreaterThan(0);
          |                               ^
      231 |       expect(after.uptimeMs).toBeLessThan(before.uptimeMs);
      232 |     });
      233 |   });

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:230:31)

  ΓùÅ EventLogMetricsCollector ΓÇ║ export ΓÇ║ should calculate queriesPerSecond

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 10000
    Received:    Infinity

      257 |       // With 10 queries and some uptime, queriesPerSecond should be positive
      258 |       expect(report.queriesPerSecond).toBeGreaterThan(0);
    > 259 |       expect(report.queriesPerSecond).toBeLessThanOrEqual(10000); // Sanity check
          |                                       ^
      260 |     });
      261 |
      262 |     it('should calculate averageResultsPerQuery', async () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:259:39)

PASS src/mcp/__tests__/tool-executor.test.ts (5.755 s)
PASS src/services/eventlog/__tests__/config.test.ts (6.099 s)
FAIL src/graphql/__tests__/cursor.test.ts (6.875 s)
  ΓùÅ Cursor Utilities ΓÇ║ encodeCursor ΓÇ║ should encode a cursor position to base64

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:19:35)

  ΓùÅ Cursor Utilities ΓÇ║ encodeCursor ΓÇ║ should encode large event IDs

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:43:35)

  ΓùÅ Cursor Utilities ΓÇ║ decodeCursor ΓÇ║ should decode a valid base64 cursor

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:58:35)

  ΓùÅ Cursor Utilities ΓÇ║ decodeCursor ΓÇ║ should handle cursor with special characters

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:90:35)

  ΓùÅ Cursor Utilities ΓÇ║ isValidCursor ΓÇ║ should return true for valid cursor

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      104 |       const cursor = encodeCursor(position);
      105 |
    > 106 |       expect(isValidCursor(cursor)).toBe(true);
          |                                     ^
      107 |     });
      108 |
      109 |     it('should return false for invalid base64', () => {

      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:106:37)

  ΓùÅ Cursor Utilities ΓÇ║ Round-trip encoding/decoding ΓÇ║ should maintain data through encode/decode cycle

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:139:37)

FAIL src/logger/__tests__/logger.test.ts
  ΓùÅ Test suite failed to run

    src/logger/__tests__/logger.test.ts:388:8 - error TS2554: Expected 2 arguments, but got 3.

    388     }, 100);
               ~~~
    src/logger/__tests__/logger.test.ts:389:3 - error TS1128: Declaration or statement expected.

    389   });
          ~
    src/logger/__tests__/logger.test.ts:389:4 - error TS1128: Declaration or statement expected.

    389   });
           ~
    src/logger/__tests__/logger.test.ts:390:1 - error TS1128: Declaration or statement expected.

    390 });
        ~
    src/logger/__tests__/logger.test.ts:390:2 - error TS1128: Declaration or statement expected.

    390 });
         ~

FAIL src/mcp/__tests__/performance.test.ts
  ΓùÅ Test suite failed to run

    src/mcp/__tests__/performance.test.ts:15:1 - error TS6192: All imports in import declaration are unused.

    15 import { ProtocolHandler, JSON_RPC_ERRORS } from '../protocol-handler';
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:18:10 - error TS6133: 'Readable' is declared but its value is never read.

    18 import { Readable, Writable } from 'stream';
                ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:23:7 - error TS6196: 'MockWritable' is declared but never used.

    23 class MockWritable extends Writable {
             ~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:107:71 - error TS2554: Expected 1 arguments, but got 2.

    107       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    108         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    109         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    110       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:113:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    113       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:119:56 - error TS2554: Expected 1 arguments, but got 2.

    119       await toolExecutor.executeTool('eventlog_query', {
                                                               ~
    120         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    121         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    122       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:128:58 - error TS2554: Expected 1 arguments, but got 2.

    128         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    129           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    130           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    131         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:148:73 - error TS2554: Expected 1 arguments, but got 2.

    148         const result = await toolExecutor.executeTool('eventlog_query', params);
                                                                                ~~~~~~
    src/mcp/__tests__/performance.test.ts:151:23 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    151         expect(result.success).toBe(true);
                              ~~~~~~~
    src/mcp/__tests__/performance.test.ts:158:71 - error TS2554: Expected 1 arguments, but got 2.

    158       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    159         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    160         limit: 'invalid', // Invalid type
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    161       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:164:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    164       expect(result.success).toBe(false);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:182:32 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    182       const result = validator.validate({ logName: 'System', limit: 100 }, schema);
                                       ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:205:32 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    205       const result = validator.validate(
                                       ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:231:19 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    231         validator.validate({ logName: 'System', limit: 100 }, schema);
                          ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:255:54 - error TS2554: Expected 1 arguments, but got 2.

    255           toolExecutor.executeTool('eventlog_query', {
                                                             ~
    256             logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    257             limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~
    258           })
        ~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:266:37 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    266       expect(results.every((r) => r.success === true)).toBe(true);
                                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:274:58 - error TS2554: Expected 1 arguments, but got 2.

    274         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    275           logName: i % 2 === 0 ? 'System' : 'Application',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    276           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    277         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:292:56 - error TS2554: Expected 1 arguments, but got 2.

    292             toolExecutor.executeTool('eventlog_query', {
                                                               ~
    293               logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    294               limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~~~
    295             })
        ~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:314:56 - error TS2554: Expected 1 arguments, but got 2.

    314             toolExecutor.executeTool('eventlog_query', {
                                                               ~
    315               logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    316               limit: 'invalid', // Error
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    317             })
        ~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:321:56 - error TS2554: Expected 1 arguments, but got 2.

    321             toolExecutor.executeTool('eventlog_query', {
                                                               ~
    322               logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    323               limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~~~
    324             })
        ~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:342:58 - error TS2554: Expected 1 arguments, but got 2.

    342         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    343           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    344           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    345         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:350:71 - error TS2554: Expected 1 arguments, but got 2.

    350       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    351         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    352         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    353       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:356:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    356       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:408:71 - error TS2554: Expected 1 arguments, but got 2.

    408       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    409         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    410         limit: 10000,
        ~~~~~~~~~~~~~~~~~~~~~
    411       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:414:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    414       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:420:71 - error TS2554: Expected 1 arguments, but got 2.

    420       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    421         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    423         offset: 50000,
        ~~~~~~~~~~~~~~~~~~~~~~
    424       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:427:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    427       expect(result.success === true || result.success === false).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:427:48 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    427       expect(result.success === true || result.success === false).toBe(true);
                                                       ~~~~~~~
    src/mcp/__tests__/performance.test.ts:437:58 - error TS2554: Expected 1 arguments, but got 2.

    437         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    438           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    439           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    440         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:454:54 - error TS2554: Expected 1 arguments, but got 2.

    454           toolExecutor.executeTool('eventlog_query', {
                                                             ~
    455             logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    456             limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~
    457           })
        ~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:473:91 - error TS2554: Expected 1 arguments, but got 2.

    473           toolExecutor.executeTool(i % 2 === 0 ? 'eventlog_query' : 'eventlog_list_logs', {
                                                                                                  ~
    474             logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    475             limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~
    476           })
        ~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:482:71 - error TS2554: Expected 1 arguments, but got 2.

    482       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    483         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    484         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    485       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:487:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    487       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:520:58 - error TS2554: Expected 1 arguments, but got 2.

    520         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    521           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    522           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    523         });
        ~~~~~~~~~

FAIL src/services/eventlog/__tests__/machine-name-anonymization.test.ts
  ΓùÅ Test suite failed to run

    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:68:28 - error TS18048: 'anonymized.message' is possibly 'undefined'.

    68       const tokenMatches = anonymized.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/g);
                                  ~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:110:22 - error TS18048: 'anonymized.message' is possibly 'undefined'.

    110       const tokens = anonymized.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/g);
                             ~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:145:22 - error TS18048: 'anon1.message' is possibly 'undefined'.

    145       const token1 = anon1.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:146:22 - error TS18048: 'anon2.message' is possibly 'undefined'.

    146       const token2 = anon2.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:160:22 - error TS18048: 'anon1.message' is possibly 'undefined'.

    160       const token1 = anon1.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:170:22 - error TS18048: 'anon2.message' is possibly 'undefined'.

    170       const token2 = anon2.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:202:22 - error TS18048: 'anonymized.message' is possibly 'undefined'.

    202       const tokens = anonymized.message.match(/\[ANON_/g) || [];
                             ~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:256:22 - error TS2532: Object is possibly 'undefined'.

    256       const token1 = anonymized[0].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:257:22 - error TS2532: Object is possibly 'undefined'.

    257       const token2 = anonymized[1].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:258:13 - error TS6133: 'token3' is declared but its value is never read.

    258       const token3 = anonymized[2].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                    ~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:258:22 - error TS2532: Object is possibly 'undefined'.

    258       const token3 = anonymized[2].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~~~~~~~~~

FAIL src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts
  ΓùÅ EventLogLibrary ΓÇ║ queryEventLog ΓÇ║ should cap maxResults at 10000

    TypeError: Cannot read properties of undefined (reading '0')

      158 |       await library.queryEventLog({ logName: 'System', maxResults: 99999 });
      159 |
    > 160 |       const call = (PowerShellModule.PowerShellExecutor.executeJson as jest.Mock).mock.calls[0][0];
          |                                                                                                ^
      161 |       expect(call).toContain('-MaxEvents 10000');
      162 |     });
      163 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts:160:96)

  ΓùÅ EventLogLibrary ΓÇ║ queryEventLog ΓÇ║ should calculate pagination metadata correctly

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      257 |       expect(result.success).toBe(true);
      258 |       expect(result.entries).toHaveLength(50);
    > 259 |       expect(result.hasNextPage).toBe(false);
          |                                  ^
      260 |       expect(result.nextOffset).toBeUndefined();
      261 |     });
      262 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts:259:34)

  ΓùÅ EventLogLibrary ΓÇ║ queryEventLog ΓÇ║ should calculate correct nextOffset with existing offset

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      297 |       const result = await library.queryEventLog({ logName: 'System', maxResults: 50, offset: 100 });
      298 |
    > 299 |       expect(result.hasNextPage).toBe(false);
          |                                  ^
      300 |       expect(result.nextOffset).toBeUndefined();
      301 |     });
      302 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts:299:34)

PASS src/services/__tests__/registry.test.ts (7.735 s)
FAIL src/graphql/__tests__/schema.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/schema.test.ts:21:30 - error TS2339: Property 'getValues' does not exist on type 'GraphQLNamedType'.
      Property 'getValues' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    21       expect(eventLevelType!.getValues().map(v => v.name)).toEqual([
                                    ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:21:46 - error TS7006: Parameter 'v' implicitly has an 'any' type.

    21       expect(eventLevelType!.getValues().map(v => v.name)).toEqual([
                                                    ~
    src/graphql/__tests__/schema.test.ts:35:33 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    35       const fields = entryType!.getFields();
                                       ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:52:36 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    52       const fields = pageInfoType!.getFields();
                                          ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:65:35 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    65       const fields = metricsType!.getFields();
                                         ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:77:34 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    77       const fields = resultType!.getFields();
                                        ~~~~~~~~~

FAIL src/mcp/__tests__/e2e-integration.test.ts
  ΓùÅ Test suite failed to run

    src/mcp/__tests__/e2e-integration.test.ts:9:27 - error TS6133: 'JSON_RPC_ERRORS' is declared but its value is never read.

    9 import { ProtocolHandler, JSON_RPC_ERRORS } from '../protocol-handler';
                                ~~~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:89:50 - error TS6133: 'params' is declared but its value is never read.

    89     handler.registerHandler('initialize', async (params: any) => {
                                                        ~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:108:58 - error TS2554: Expected 1 arguments, but got 2.

    108       return await toolExecutor.executeTool(params.name, params.arguments);
                                                                 ~~~~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:116:34 - error TS2554: Expected 2 arguments, but got 1.

    116       const initResponse = await initHandler({
                                         ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:116:34 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    116       const initResponse = await initHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:116:34 - error TS18048: 'initHandler' is possibly 'undefined'.

    116       const initResponse = await initHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:123:14 - error TS18046: 'initResponse' is of type 'unknown'.

    123       expect(initResponse.protocolVersion).toBe('2024-11-05');
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:124:14 - error TS18046: 'initResponse' is of type 'unknown'.

    124       expect(initResponse.capabilities).toBeDefined();
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:125:14 - error TS18046: 'initResponse' is of type 'unknown'.

    125       expect(initResponse.serverInfo).toBeDefined();
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:129:34 - error TS2554: Expected 2 arguments, but got 1.

    129       const listResponse = await listHandler({});
                                         ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:129:34 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    129       const listResponse = await listHandler({});
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:129:34 - error TS18048: 'listHandler' is possibly 'undefined'.

    129       const listResponse = await listHandler({});
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:131:14 - error TS18046: 'listResponse' is of type 'unknown'.

    131       expect(listResponse.tools).toBeDefined();
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:132:28 - error TS18046: 'listResponse' is of type 'unknown'.

    132       expect(Array.isArray(listResponse.tools)).toBe(true);
                                   ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:133:14 - error TS18046: 'listResponse' is of type 'unknown'.

    133       expect(listResponse.tools.length).toBeGreaterThan(0);
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:137:34 - error TS2554: Expected 2 arguments, but got 1.

    137       const callResponse = await callHandler({
                                         ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:137:34 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    137       const callResponse = await callHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:137:34 - error TS18048: 'callHandler' is possibly 'undefined'.

    137       const callResponse = await callHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:146:14 - error TS18046: 'callResponse' is of type 'unknown'.

    146       expect(callResponse.success).toBe(true);
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:151:30 - error TS2554: Expected 2 arguments, but got 1.

    151       const response = await initHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:151:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    151       const response = await initHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:151:30 - error TS18048: 'initHandler' is possibly 'undefined'.

    151       const response = await initHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:158:14 - error TS18046: 'response' is of type 'unknown'.

    158       expect(response.serverInfo.name).toBe('SysMCP');
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:159:14 - error TS18046: 'response' is of type 'unknown'.

    159       expect(response.serverInfo.version).toBe('1.0.0');
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:164:30 - error TS2554: Expected 2 arguments, but got 1.

    164       const response = await listHandler({});
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:164:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    164       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:164:30 - error TS18048: 'listHandler' is possibly 'undefined'.

    164       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:166:14 - error TS18046: 'response' is of type 'unknown'.

    166       expect(response.tools).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:167:21 - error TS18046: 'response' is of type 'unknown'.

    167       const tools = response.tools as any[];
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:177:30 - error TS2554: Expected 2 arguments, but got 1.

    177       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:177:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    177       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:177:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    177       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:186:14 - error TS18046: 'response' is of type 'unknown'.

    186       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:187:14 - error TS18046: 'response' is of type 'unknown'.

    187       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:192:30 - error TS2554: Expected 2 arguments, but got 1.

    192       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:192:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    192       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:192:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    192       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:197:14 - error TS18046: 'response' is of type 'unknown'.

    197       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:198:14 - error TS18046: 'response' is of type 'unknown'.

    198       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:222:34 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    222         const result = validator.validate({ logName: 'System', limit: 10 }, tool.inputSchema);
                                         ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:246:30 - error TS2554: Expected 2 arguments, but got 1.

    246       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:246:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    246       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:246:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    246       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:257:14 - error TS18046: 'response' is of type 'unknown'.

    257       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:258:14 - error TS18046: 'response' is of type 'unknown'.

    258       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:263:30 - error TS2554: Expected 2 arguments, but got 1.

    263       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:263:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    263       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:263:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    263       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:270:14 - error TS18046: 'response' is of type 'unknown'.

    270       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:275:30 - error TS2554: Expected 2 arguments, but got 1.

    275       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:275:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    275       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:275:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    275       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:284:14 - error TS18046: 'response' is of type 'unknown'.

    284       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:285:21 - error TS18046: 'response' is of type 'unknown'.

    285       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:291:30 - error TS2554: Expected 2 arguments, but got 1.

    291       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:291:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    291       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:291:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    291       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:300:14 - error TS18046: 'response' is of type 'unknown'.

    300       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:307:30 - error TS2554: Expected 2 arguments, but got 1.

    307       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:307:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    307       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:307:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    307       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:316:14 - error TS18046: 'response' is of type 'unknown'.

    316       expect(response.success).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:317:21 - error TS18046: 'response' is of type 'unknown'.

    317       expect(typeof response.success).toBe('boolean');
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:318:14 - error TS18046: 'response' is of type 'unknown'.

    318       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:323:30 - error TS2554: Expected 2 arguments, but got 1.

    323       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:323:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    323       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:323:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    323       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:331:14 - error TS18046: 'response' is of type 'unknown'.

    331       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:332:21 - error TS18046: 'response' is of type 'unknown'.

    332       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:339:30 - error TS2554: Expected 2 arguments, but got 1.

    339       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:339:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    339       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:339:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    339       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:347:14 - error TS18046: 'response' is of type 'unknown'.

    347       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:348:21 - error TS18046: 'response' is of type 'unknown'.

    348       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:355:30 - error TS2554: Expected 2 arguments, but got 1.

    355       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:355:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    355       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:355:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    355       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:364:14 - error TS18046: 'response' is of type 'unknown'.

    364       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:365:21 - error TS18046: 'response' is of type 'unknown'.

    365       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:373:30 - error TS2554: Expected 2 arguments, but got 1.

    373       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:373:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    373       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:373:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    373       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:378:14 - error TS18046: 'response' is of type 'unknown'.

    378       expect(response.success).toBe(false);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:379:14 - error TS18046: 'response' is of type 'unknown'.

    379       expect(response.error).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:384:30 - error TS2554: Expected 2 arguments, but got 1.

    384       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:384:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    384       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:384:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    384       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:392:14 - error TS18046: 'response' is of type 'unknown'.

    392       expect(response.success).toBe(false);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:393:14 - error TS18046: 'response' is of type 'unknown'.

    393       expect(response.error).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:398:30 - error TS2554: Expected 2 arguments, but got 1.

    398       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:398:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    398       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:398:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    398       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:403:14 - error TS18046: 'response' is of type 'unknown'.

    403       expect(response.success).toBe(false);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:410:35 - error TS2554: Expected 2 arguments, but got 1.

    410       const errorResponse = await callHandler({
                                          ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:410:35 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    410       const errorResponse = await callHandler({
                                          ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:410:35 - error TS18048: 'callHandler' is possibly 'undefined'.

    410       const errorResponse = await callHandler({
                                          ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:418:14 - error TS18046: 'errorResponse' is of type 'unknown'.

    418       expect(errorResponse.success).toBe(false);
                     ~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:421:37 - error TS2554: Expected 2 arguments, but got 1.

    421       const successResponse = await callHandler({
                                            ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:421:37 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    421       const successResponse = await callHandler({
                                            ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:421:37 - error TS18048: 'callHandler' is possibly 'undefined'.

    421       const successResponse = await callHandler({
                                            ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:429:14 - error TS18046: 'successResponse' is of type 'unknown'.

    429       expect(successResponse.success).toBe(true);
                     ~~~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:444:32 - error TS2554: Expected 2 arguments, but got 1.

    444         const response = await callHandler({
                                       ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:444:32 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    444         const response = await callHandler({
                                       ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:444:32 - error TS18048: 'callHandler' is possibly 'undefined'.

    444         const response = await callHandler({
                                       ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:455:30 - error TS2554: Expected 2 arguments, but got 1.

    455       const response = await listHandler({});
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:455:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    455       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:455:30 - error TS18048: 'listHandler' is possibly 'undefined'.

    455       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:457:21 - error TS18046: 'response' is of type 'unknown'.

    457       const tools = response.tools as any[];
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:471:31 - error TS2554: Expected 2 arguments, but got 1.

    471       const response1 = await callHandler({
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:471:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    471       const response1 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:471:31 - error TS18048: 'callHandler' is possibly 'undefined'.

    471       const response1 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:476:14 - error TS18046: 'response1' is of type 'unknown'.

    476       expect(response1.success).toBe(true);
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:479:31 - error TS2554: Expected 2 arguments, but got 1.

    479       const response2 = await callHandler({
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:479:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    479       const response2 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:479:31 - error TS18048: 'callHandler' is possibly 'undefined'.

    479       const response2 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:487:14 - error TS18046: 'response2' is of type 'unknown'.

    487       expect(response2.success).toBe(true);
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:490:31 - error TS2554: Expected 2 arguments, but got 1.

    490       const response3 = await callHandler({
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:490:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    490       const response3 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:490:31 - error TS18048: 'callHandler' is possibly 'undefined'.

    490       const response3 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:498:14 - error TS18046: 'response3' is of type 'unknown'.

    498       expect(response3.success).toBe(true);
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:504:31 - error TS2554: Expected 2 arguments, but got 1.

    504       const response1 = await listHandler({});
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:504:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    504       const response1 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:504:31 - error TS18048: 'listHandler' is possibly 'undefined'.

    504       const response1 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:505:31 - error TS2554: Expected 2 arguments, but got 1.

    505       const response2 = await listHandler({});
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:505:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    505       const response2 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:505:31 - error TS18048: 'listHandler' is possibly 'undefined'.

    505       const response2 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:507:14 - error TS18046: 'response1' is of type 'unknown'.

    507       expect(response1.tools).toBeDefined();
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:508:14 - error TS18046: 'response2' is of type 'unknown'.

    508       expect(response2.tools).toBeDefined();
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:509:15 - error TS18046: 'response1' is of type 'unknown'.

    509       expect((response1.tools as any[]).length).toBe((response2.tools as any[]).length);
                      ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:509:55 - error TS18046: 'response2' is of type 'unknown'.

    509       expect((response1.tools as any[]).length).toBe((response2.tools as any[]).length);
                                                              ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:527:30 - error TS2554: Expected 2 arguments, but got 1.

    527       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:527:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    527       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:527:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    527       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:536:14 - error TS18046: 'response' is of type 'unknown'.

    536       expect(response.success).toBe(true);
                     ~~~~~~~~

FAIL src/services/eventlog/lib/src/__tests__/anonymizer.test.ts
  ΓùÅ Console

    console.log
      Anonymized 1000 entries in 103ms

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:474:15)

  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should anonymize DOMAIN\username format

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      61 |
      62 |       const result = anonymizer.anonymizeEntry(entry);
    > 63 |       expect(result.userId).toContain('[ANON_USER_');
         |                             ^
      64 |       expect(result.userId).not.toContain('jsmith');
      65 |       expect(result.userId).not.toContain('CONTOSO\\jsmith');
      66 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:63:29)

  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should handle username in message

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      72 |
      73 |       const result = anonymizer.anonymizeEntry(entry);
    > 74 |       expect(result.message).toContain('[ANON_USER_');
         |                              ^
      75 |       expect(result.message).not.toContain('employee123');
      76 |       expect(result.message).toContain('logged in');
      77 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:74:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should handle multiple usernames in same field

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: undefined

      83 |
      84 |       const result = anonymizer.anonymizeEntry(entry);
    > 85 |       expect(result.message?.match(/\[ANON_USER_/g)?.length).toBe(2);
         |                                                              ^
      86 |       expect(result.message).not.toContain('user1');
      87 |       expect(result.message).not.toContain('user2');
      88 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:85:62)

  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should handle usernames with various formats

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      100 |         const result = anonymizer.anonymizeEntry(entry);
      101 |         expect(result.userId).not.toContain('\\');
    > 102 |         expect(result.userId).toContain('[ANON_USER_');
          |                               ^
      103 |       });
      104 |     });
      105 |   });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:102:31
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:98:17)

  ΓùÅ PiiAnonymizer ΓÇ║ Computer Name Anonymization ΓÇ║ should not anonymize regular words that are not computer names

    expect(received).toContain(expected) // indexOf

    Expected substring: "system"
    Received string:    "[ANON_COMPUTER_87EF56]"

      132 |       const result = anonymizer.anonymizeEntry(entry);
      133 |       // Common lowercase words should not be anonymized
    > 134 |       expect(result.message).toContain('system');
          |                              ^
      135 |       expect(result.message).toContain('processed');
      136 |     });
      137 |   });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:134:30)

  ΓùÅ PiiAnonymizer ΓÇ║ IPv4 Address Anonymization ΓÇ║ should anonymize IPv4 addresses

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_IP_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      152 |
      153 |         const result = anonymizer.anonymizeEntry(entry);
    > 154 |         expect(result.message).toContain('[ANON_IP_');
          |                                ^
      155 |         expect(result.message).not.toContain(ip);
      156 |       });
      157 |     });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:154:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:148:21)

  ΓùÅ PiiAnonymizer ΓÇ║ IPv4 Address Anonymization ΓÇ║ should handle multiple IPs in same message

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: undefined

      163 |
      164 |       const result = anonymizer.anonymizeEntry(entry);
    > 165 |       expect(result.message?.match(/\[ANON_IP_/g)?.length).toBe(2);
          |                                                            ^
      166 |     });
      167 |   });
      168 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:165:60)

  ΓùÅ PiiAnonymizer ΓÇ║ IPv6 Address Anonymization ΓÇ║ should anonymize IPv6 addresses

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_IP_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      182 |
      183 |         const result = anonymizer.anonymizeEntry(entry);
    > 184 |         expect(result.message).toContain('[ANON_IP_');
          |                                ^
      185 |         expect(result.message).not.toContain(ip);
      186 |       });
      187 |     });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:184:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:178:21)

  ΓùÅ PiiAnonymizer ΓÇ║ Email Address Anonymization ΓÇ║ should anonymize email addresses

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_EMAIL_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      203 |
      204 |         const result = anonymizer.anonymizeEntry(entry);
    > 205 |         expect(result.message).toContain('[ANON_EMAIL_');
          |                                ^
      206 |         expect(result.message).not.toContain('@');
      207 |         expect(result.message).not.toContain(email);
      208 |       });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:205:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:199:18)

  ΓùÅ PiiAnonymizer ΓÇ║ Email Address Anonymization ΓÇ║ should handle multiple emails in same message

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: undefined

      215 |
      216 |       const result = anonymizer.anonymizeEntry(entry);
    > 217 |       expect(result.message?.match(/\[ANON_EMAIL_/g)?.length).toBe(2);
          |                                                               ^
      218 |     });
      219 |   });
      220 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:217:63)

  ΓùÅ PiiAnonymizer ΓÇ║ File Path Anonymization ΓÇ║ should anonymize Windows user profile paths

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      236 |         expect(result.message).not.toContain('admin');
      237 |         expect(result.message).not.toContain('operator');
    > 238 |         expect(result.message).toContain('[ANON_USER_');
          |                                ^
      239 |       });
      240 |     });
      241 |

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:238:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:229:17)

  ΓùÅ PiiAnonymizer ΓÇ║ File Path Anonymization ΓÇ║ should preserve path structure when anonymizing

    expect(received).toContain(expected) // indexOf

    Expected substring: "C:\\Users\\"
    Received string:    "[ANON_COMPUTER_87EF56]"

      246 |
      247 |       const result = anonymizer.anonymizeEntry(entry);
    > 248 |       expect(result.message).toContain('C:\\Users\\');
          |                              ^
      249 |       expect(result.message).toContain('\\Documents\\file.txt');
      250 |     });
      251 |   });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:248:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Mixed PII in Single Message ΓÇ║ should anonymize multiple PII types in one message

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      266 |       
      267 |       // Check anonymization tokens exist
    > 268 |       expect(result.message).toContain('[ANON_USER_');
          |                              ^
      269 |       expect(result.message).toContain('[ANON_EMAIL_');
      270 |       expect(result.message).toContain('[ANON_IP_');
      271 |       expect(result.message).toContain('[ANON_COMPUTER_');

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:268:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Consistency (Deterministic Hashing) ΓÇ║ should maintain consistency across multiple queries

    expect(received).toEqual(expected) // deep equality

    Expected: undefined
    Received: "[ANON_COMPUTER_87EF56]"

      297 |       expect(result1.userId).toBe(result2.userId);
      298 |       // And the username in message should also match
    > 299 |       expect(result1.userId).toEqual(
          |                              ^
      300 |         result2.message?.match(/\[ANON_USER_[^\]]+\]/)?.[0]
      301 |       );
      302 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:299:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Consistency (Deterministic Hashing) ΓÇ║ should produce different tokens for different inputs

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not "[ANON_COMPUTER_87EF56]"

      309 |       const result2 = anonymizer.anonymizeEntry(entry2);
      310 |
    > 311 |       expect(result1.userId).not.toBe(result2.userId);
          |                                  ^
      312 |     });
      313 |   });
      314 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:311:34)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle null values

    expect(received).toBe(expected) // Object.is equality

    Expected: "Test message"
    Received: "[ANON_COMPUTER_87EF56]"

      322 |       const result = anonymizer.anonymizeEntry(entry);
      323 |       expect(result.userId).toBeNull();
    > 324 |       expect(result.message).toBe('Test message');
          |                              ^
      325 |     });
      326 |
      327 |     it('should handle empty strings', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:324:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle empty strings

    expect(received).toBe(expected) // Object.is equality

    Expected: "Test"
    Received: "[ANON_COMPUTER_87EF56]"

      333 |       const result = anonymizer.anonymizeEntry(entry);
      334 |       expect(result.userId).toBe('');
    > 335 |       expect(result.message).toBe('Test');
          |                              ^
      336 |     });
      337 |
      338 |     it('should handle undefined values', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:335:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle undefined values

    expect(received).toBe(expected) // Object.is equality

    Expected: "Test message"
    Received: "[ANON_COMPUTER_87EF56]"

      342 |
      343 |       const result = anonymizer.anonymizeEntry(entry);
    > 344 |       expect(result.message).toBe('Test message');
          |                              ^
      345 |       expect(result.userId).toBeUndefined();
      346 |     });
      347 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:344:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle non-string fields

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      358 |       expect(result.eventId).toBe(456);
      359 |       expect(result.timeCreated).toEqual(new Date('2024-01-01'));
    > 360 |       expect(result.message).toContain('[ANON_USER_');
          |                              ^
      361 |     });
      362 |
      363 |     it('should handle strings with no PII', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:360:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle strings with no PII

    expect(received).toBe(expected) // Object.is equality

    Expected: "System startup completed successfully"
    Received: "[ANON_COMPUTER_87EF56]"

      367 |
      368 |       const result = anonymizer.anonymizeEntry(entry);
    > 369 |       expect(result.message).toBe('System startup completed successfully');
          |                              ^
      370 |     });
      371 |
      372 |     it('should handle malformed data gracefully', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:369:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Mapping Persistence ΓÇ║ should load mapping from file

    expect(received).toBeDefined()

    Received: undefined

      408 |       // Load and verify
      409 |       const loaded = await PiiAnonymizer.loadMapping(mappingFile);
    > 410 |       expect(loaded.usernames.get('DOMAIN\\jsmith')).toBeDefined();
          |                                                      ^
      411 |     });
      412 |
      413 |     it('should maintain consistency after reload', async () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:410:54)

  ΓùÅ PiiAnonymizer ΓÇ║ Mapping Persistence ΓÇ║ should maintain consistency after reload

    expect(received).toBe(expected) // Object.is equality

    Expected: undefined
    Received: "[ANON_COMPUTER_87EF56]"

      426 |       const entry = { userId: 'DOMAIN\\jsmith' };
      427 |       const result = anonymizer2.anonymizeEntry(entry);
    > 428 |       expect(result.userId).toBe(token1);
          |                             ^
      429 |     });
      430 |
      431 |     it('should handle missing file gracefully', async () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:428:29)

  ΓùÅ PiiAnonymizer ΓÇ║ getMapping() ΓÇ║ should return current mapping

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      481 |       
      482 |       const mapping = anonymizer.getMapping();
    > 483 |       expect(mapping.usernames.size).toBe(1);
          |                                      ^
      484 |       expect(mapping.usernames.has('DOMAIN\\user1')).toBe(true);
      485 |     });
      486 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:483:38)

  ΓùÅ PiiAnonymizer ΓÇ║ getMapping() ΓÇ║ should allow inspection of all mapping types

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      493 |
      494 |       const mapping = anonymizer.getMapping();
    > 495 |       expect(mapping.usernames.size).toBeGreaterThan(0);
          |                                      ^
      496 |       expect(mapping.computerNames.size).toBeGreaterThan(0);
      497 |       expect(mapping.emails.size).toBeGreaterThan(0);
      498 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:495:38)

  ΓùÅ PiiAnonymizer ΓÇ║ Real-World Scenarios ΓÇ║ should handle typical Windows event log entry

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      528 |
      529 |       // Verify anonymization tokens exist
    > 530 |       expect(result.message).toContain('[ANON_USER_');
          |                              ^
      531 |       expect(result.message).toContain('[ANON_IP_');
      532 |     });
      533 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:530:30)

FAIL src/mcp/__tests__/protocol-handler.test.ts (8.07 s)
  ΓùÅ ProtocolHandler ΓÇ║ Initialization ΓÇ║ prevents tools/list before initialization

    expect(received).toBeDefined()

    Received: undefined

      513 |
      514 |       const response = JSON.parse(mockOutput.output[0]);
    > 515 |       expect(response.error).toBeDefined();
          |                              ^
      516 |       expect(response.error.code).toBe(-32002);
      517 |     });
      518 |

      at Object.<anonymous> (src/mcp/__tests__/protocol-handler.test.ts:515:30)

FAIL src/graphql/__tests__/eventlog.performance.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.performance.test.ts:15:1 - error TS6133: 'EventLevel' is declared but its value is never read.

    15 import { EventLevel } from '../../services/eventlog/types';
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.performance.test.ts:141:28 - error TS2339: Property 'mockClear' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    141         mockProvider.query.mockClear();
                                   ~~~~~~~~~
    src/graphql/__tests__/eventlog.performance.test.ts:142:28 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    142         mockProvider.query.mockResolvedValue({
                                   ~~~~~~~~~~~~~~~~~

FAIL src/graphql/__tests__/eventlog.resolver.metrics.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:11:1 - error TS6133: 'EventLevel' is declared but its value is never read.

    11 import { EventLevel } from '../../services/eventlog/types';
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:43:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    43       mockProvider.query.mockResolvedValue({
                                ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:72:26 - error TS2339: Property 'mockRejectedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    72       mockProvider.query.mockRejectedValue(new Error('Query failed'));
                                ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:92:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    92       mockProvider.query.mockResolvedValue({
                                ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:130:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    130       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:164:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    164       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:192:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    192       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:224:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    224       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:243:26 - error TS2339: Property 'mockImplementation' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    243       mockProvider.query.mockImplementation(
                                 ~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:267:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    267       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:289:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    289       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:354:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    354       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~

FAIL src/services/eventlog/__tests__/anonymization-store.test.ts (8.257 s)
  ΓùÅ AnonymizationStore ΓÇ║ Error Handling ΓÇ║ should handle concurrent save operations safely

    ENOENT: no such file or directory, rename 'C:\Users\chris\Code\SysMCP\src\services\eventlog\__tests__\test-store-1770677299455\mapping.json.tmp' -> 'C:\Users\chris\Code\SysMCP\src\services\eventlog\__tests__\test-store-1770677299455\mapping.json'



FAIL src/services/__tests__/lifecycle.test.ts
  ΓùÅ Test suite failed to run

    src/services/__tests__/lifecycle.test.ts:8:1 - error TS6133: 'ServiceConfig' is declared but its value is never read.

    8 import { ServiceConfig } from '../types';
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL src/__tests__/watcher.test.ts
  ΓùÅ Test suite failed to run

    src/__tests__/watcher.test.ts:63:13 - error TS6133: 'startPromise' is declared but its value is never read.

    63       const startPromise = watcher.start();
                   ~~~~~~~~~~~~
    src/__tests__/watcher.test.ts:172:13 - error TS6133: 'startPromise' is declared but its value is never read.

    172       const startPromise = watcher.start();
                    ~~~~~~~~~~~~
    src/__tests__/watcher.test.ts:204:13 - error TS6133: 'startPromise' is declared but its value is never read.

    204       const startPromise = watcher.start();
                    ~~~~~~~~~~~~

FAIL src/graphql/__tests__/eventlog.resolver.anonymization.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.resolver.anonymization.test.ts:8:1 - error TS6133: 'PiiAnonymizer' is declared but its value is never read.

    8 import { PiiAnonymizer } from '../../services/eventlog/lib/src/anonymizer';
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL src/graphql/__tests__/eventlog.resolver.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.resolver.test.ts:8:1 - error TS6133: 'EventLevel' is declared but its value is never read.

    8 import { EventLevel } from '../../services/eventlog/types';
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:248:28 - error TS2339: Property 'mockClear' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    248         mockProvider.query.mockClear();
                                   ~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:731:7 - error TS2304: Cannot find name 'mockProvider'.

    731       mockProvider.query = jest.fn().mockResolvedValue({
              ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:737:71 - error TS2304: Cannot find name 'context'.

    737       await eventLogsResolver(null, { logName: 'System', offset: 0 }, context);
                                                                              ~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:739:14 - error TS2304: Cannot find name 'mockProvider'.

    739       expect(mockProvider.query).toHaveBeenCalledWith(
                     ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:750:7 - error TS2304: Cannot find name 'mockProvider'.

    750       mockProvider.query = jest.fn().mockResolvedValue({
              ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:756:72 - error TS2304: Cannot find name 'context'.

    756       await eventLogsResolver(null, { logName: 'System', limit: 100 }, context);
                                                                               ~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:758:14 - error TS2304: Cannot find name 'mockProvider'.

    758       expect(mockProvider.query).toHaveBeenCalledWith(
                     ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:768:1 - error TS1128: Declaration or statement expected.

    768 });
        ~
    src/graphql/__tests__/eventlog.resolver.test.ts:768:2 - error TS1128: Declaration or statement expected.

    768 });
         ~

FAIL src/config/config.test.ts
  ΓùÅ Test suite failed to run

    src/config/config.test.ts:1:10 - error TS2459: Module '"../index"' declares 'createConfig' locally, but it is not exported.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
               ~~~~~~~~~~~~

      src/index.ts:6:10
        6 import { createConfig, Config } from './config';
                   ~~~~~~~~~~~~
        'createConfig' is declared here.
    src/config/config.test.ts:1:24 - error TS2305: Module '"../index"' has no exported member 'isDevelopment'.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                             ~~~~~~~~~~~~~
    src/config/config.test.ts:1:39 - error TS2305: Module '"../index"' has no exported member 'isProduction'.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                                            ~~~~~~~~~~~~
    src/config/config.test.ts:1:53 - error TS2459: Module '"../index"' declares 'Config' locally, but it is not exported.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                                                          ~~~~~~

      src/index.ts:6:24
        6 import { createConfig, Config } from './config';
                                 ~~~~~~
        'Config' is declared here.
    src/config/config.test.ts:1:53 - error TS6133: 'Config' is declared but its value is never read.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                                                          ~~~~~~

FAIL src/services/eventlog/__tests__/eventlog.integration.test.ts
  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Basic Query Pipeline ΓÇ║ should query system log with no filters and return anonymized entries

    expect(received).toBe(expected) // Object.is equality

    Expected: "System startup"
    Received: "[ANON_COMPUTER_87EF56]"

      100 |
      101 |       // Verify anonymization
    > 102 |       expect(result.entries[0].message).toBe('System startup');
          |                                         ^
      103 |       expect(result.entries[1].message).not.toContain('DOMAIN\\user');
      104 |       expect(result.entries[1].username).not.toBe('DOMAIN\\user');
      105 |     });

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:102:41)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Filtered Queries ΓÇ║ should apply message filter correctly

    expect(received).toContain(expected) // indexOf

    Expected substring: "performed"
    Received string:    "[ANON_COMPUTER_87EF56]"

      309 |       expect(result.entries.length).toBe(1);
      310 |       // Verify message still matches the filter (even if PII is anonymized)
    > 311 |       expect(result.entries[0].message).toContain('performed');
          |                                         ^
      312 |     });
      313 |
      314 |     it('should apply multiple filters together', async () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:311:41)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Consistency Across Queries ΓÇ║ should maintain consistency with same PII appearing in different entries

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not "[ANON_COMPUTER_87EF56]"

      513 |       const computer1 = result.entries[0].computername;
      514 |       const computer2 = result.entries[1].computername;
    > 515 |       expect(computer1).not.toBe(computer2);
          |                             ^
      516 |     });
      517 |   });
      518 |

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:515:29)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Error Cases ΓÇ║ should handle invalid parameters

    expect(received).rejects.toThrow(expected)

    Expected substring: "limit must be between 1 and 10000"
    Received message:   "limit must be between 1 and 1000"

          51 |     internalDetails?: string
          52 |   ) {
        > 53 |     super(message, {
             |     ^
          54 |       extensions: {
          55 |         code,
          56 |         timestamp: new Date().toISOString()

      at new EventLogGraphQLError (src/graphql/eventlog.resolver.ts:53:5)
      at validateArgs (src/graphql/eventlog.resolver.ts:171:11)
      at eventLogsResolver (src/graphql/eventlog.resolver.ts:244:5)
      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:551:39)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:557:36)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Metrics Collection ΓÇ║ should collect correct metrics

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      601 |       );
      602 |
    > 603 |       expect(result.metrics.queryCount).toBe(1);
          |                                         ^
      604 |       expect(result.metrics.resultsReturned).toBe(25);
      605 |       expect(result.metrics.responseDurationMs).toBeGreaterThanOrEqual(0);
      606 |     });

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:603:41)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Audit Logging ΓÇ║ should log errors with appropriate detail

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "EventLog query failed", ObjectContaining {"logName": "System"}
    Received: "Unknown error during EventLog query", {"durationMs": 0, "error": "Test error", "logName": "System", "stack": "Error: Test error

      671 |     it('should log errors with appropriate detail', async () => {
      672 |       mockProvider.query = jest.fn().mockRejectedValue(
    > 673 |         new Error('Test error')
          |         ^
      674 |       );
      675 |
      676 |       try {

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:673:9)
      Number of calls: 1
      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:686:32)

FAIL src/services/eventlog/__tests__/anonymization.security.test.ts
  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Domain\username format

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "jsmith"
    Received string:        "CONTOSO\\jsmith"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Domain with dots

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "john.doe"
    Received string:        "corp.example\\john.doe"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Email-style username

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user@domain.com"
    Received string:        "user@domain.com"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Administrator account

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "Administrator"
    Received string:        "Administrator"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize System account

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "SYSTEM"
    Received string:        "SYSTEM"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Service account

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "svc_account"
    Received string:        "DOMAIN\\svc_account"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Numeric suffix username

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user123"
    Received string:        "DOMAIN\\user123"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Standard computer name

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "WORKSTATION1"
    Received string:        "WORKSTATION1"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Server naming pattern

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "SERVER-APP-01"
    Received string:        "SERVER-APP-01"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Laptop naming pattern

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "LAPTOP-JSMITH"
    Received string:        "LAPTOP-JSMITH"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Database server

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "DB-PROD-01"
    Received string:        "DB-PROD-01"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Domain computer

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "CORP-PC-001"
    Received string:        "CORP-PC-001"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize IPv4 address

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "192.168.1.100"
    Received string:        "Login from 192.168.1.100"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize Localhost IPv4

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "127.0.0.1"
    Received string:        "Login from 127.0.0.1"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize Private network range

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "10.0.0.50"
    Received string:        "Login from 10.0.0.50"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize IPv6 address

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "2001:db8::1"
    Received string:        "Login from 2001:db8::1"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize IPv6 localhost

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "::1"
    Received string:        "Login from ::1"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Corporate email

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "john.smith@company.com"
    Received string:        "Email notification sent to john.smith@company.com"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Email with plus addressing

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user+test@example.com"
    Received string:        "Email notification sent to user+test@example.com"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Domain-local email

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "admin@corp.local"
    Received string:        "Email notification sent to admin@corp.local"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Email with numbers

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user123@example.com"
    Received string:        "Email notification sent to user123@example.com"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ File Path Anonymization Security ΓÇ║ should anonymize Windows user profile path

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "jsmith"
    Received string:        "File access: C:\\Users\\jsmith\\Documents"

      385 |
      386 |         testCase.shouldNotContain.forEach(pattern => {
    > 387 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      388 |         });
      389 |       });
      390 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:387:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:386:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ File Path Anonymization Security ΓÇ║ should anonymize User AppData path

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user"
    Received string:        "File access: C:\\Users\\user\\AppData\\Local"

      385 |
      386 |         testCase.shouldNotContain.forEach(pattern => {
    > 387 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      388 |         });
      389 |       });
      390 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:387:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:386:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ File Path Anonymization Security ΓÇ║ should anonymize Shared network path

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "john"
    Received string:        "File access: \\\\SERVER\\Share\\Users\\john"

      385 |
      386 |         testCase.shouldNotContain.forEach(pattern => {
    > 387 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      388 |         });
      389 |       });
      390 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:387:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:386:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Embedded PII in Messages ΓÇ║ should anonymize multiple PII instances in single message

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "jsmith"
    Received string:        "User DOMAIN\\jsmith from WORKSTATION1 at 192.168.1.100 tried to access share from SERVER1"

      425 |
      426 |       // Verify no original PII in message
    > 427 |       expect(entry.message).not.toContain('jsmith');
          |                                 ^
      428 |       expect(entry.message).not.toContain('WORKSTATION1');
      429 |       expect(entry.message).not.toContain('192.168.1.100');
      430 |       expect(entry.message).not.toContain('SERVER1');

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:427:33)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Embedded PII in Messages ΓÇ║ should handle repeated PII values with consistent anonymization

    expect(received).not.toBeNull()

    Received: null

      471 |       // Extract anonymized username from first occurrence
      472 |       const match = entry.message.match(/ANON_USER_[a-zA-Z0-9]+/);
    > 473 |       expect(match).not.toBeNull();
          |                         ^
      474 |
      475 |       const anonUsername = match![0];
      476 |

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:473:25)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Realistic Event Log Scenarios ΓÇ║ should anonymize successful login event

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "JSmith"
    Received string:        "An account was successfully logged on.
    Subject:
    	Security ID:		S-1-5-18
    	Account Name:		CONTOSO\\\\JSmith

    Logon Information:
    	Logon Type:		3
    	Restricted Admin Mode:	-
    	Virtual Account:		No
    	Elevated Token:		No

    Impersonation Level:		Impersonation

    New Logon:
    	Security ID:		S-1-5-21-3623811015-3361044348-30300820-1013
    	Account Name:		JSmith
    	Account Domain:		CONTOSO
    	Logon ID:		0x30D695
    	Logon GUID:		{00000000-0000-0000-0000-000000000000}"

      519 |
      520 |       // Verify PII is anonymized
    > 521 |       expect(entry.message).not.toContain('JSmith');
          |                                 ^
      522 |       expect(entry.message).not.toContain('CONTOSO\\JSmith');
      523 |       expect(entry.message).not.toContain('SERVER-PROD-01');
      524 |     });

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:521:33)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Realistic Event Log Scenarios ΓÇ║ should anonymize service installation event with file paths

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "DOMAIN\\ServiceAccount"
    Received string:        "Service installed.
    Service Name: MyService
    Image Path: C:\\Program Files\\MyApp\\service.exe
    Service Type: user mode service
    Start Type: auto start
    Account: DOMAIN\\ServiceAccount"

      557 |
      558 |       // Verify service account is anonymized
    > 559 |       expect(entry.message).not.toContain('DOMAIN\\ServiceAccount');
          |                                 ^
      560 |       expect(entry.message).not.toContain('ServiceAccount');
      561 |     });
      562 |

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:559:33)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Realistic Event Log Scenarios ΓÇ║ should anonymize network connection event with IPs

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "192.168.1.100"
    Received string:        "The Windows Filtering Platform has blocked a connection.
    Application Information:
    	Process ID:		1234
    	Application Path:	\\device\\harddiskvolume2\\windows\\notepad.exe
    Network Information:
    	Direction:		Inbound
    	Source Address:		192.168.1.100
    	Source Port:		50123
    	Destination Address:	10.0.0.5
    	Destination Port:	443"

      594 |
      595 |       // Verify IPs are anonymized
    > 596 |       expect(entry.message).not.toContain('192.168.1.100');
          |                                 ^
      597 |       expect(entry.message).not.toContain('10.0.0.5');
      598 |       expect(entry.message).not.toContain('WORKSTATION-01');
      599 |       expect(entry.message).not.toContain('DOMAIN\\NetworkUser');

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:596:33)

FAIL tests/integration.test.ts
  ΓùÅ Test suite failed to run

    tests/integration.test.ts:6:56 - error TS2307: Cannot find module '../../src/index' or its corresponding type declarations.

    6 import { initializeApp, shutdownApp, AppContext } from '../../src/index';
                                                             ~~~~~~~~~~~~~~~~~

PASS src/graphql/__tests__/resolvers.test.ts
  ΓùÅ Console

    console.log
      {"timestamp":"2026-02-09T22:48:19.912Z","level":"error","service":"graphql-test","message":"Service 'non-existent' not found"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.928Z","level":"error","service":"graphql-test","message":"Error starting service","context":{"error":"Service 'non-existent' not found","name":"non-existent"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.931Z","level":"error","service":"graphql-test","message":"Service 'non-existent' not found"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.932Z","level":"error","service":"graphql-test","message":"Error stopping service","context":{"error":"Service 'non-existent' not found","name":"non-existent"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.933Z","level":"error","service":"graphql-test","message":"Service 'non-existent' not found"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.933Z","level":"error","service":"graphql-test","message":"Service restart failed: non-existent","context":{"error":"Service 'non-existent' not found"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.934Z","level":"error","service":"graphql-test","message":"Error restarting service","context":{"error":"Service 'non-existent' not found","name":"non-existent"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.935Z","level":"error","service":"graphql-test","message":"Error retrieving services","context":{"error":"Registry error"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:19.950Z","level":"error","service":"graphql-test","message":"Error registering service","context":{"error":"Registration error"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

PASS src/services/eventlog/lib/src/__tests__/powershell-executor.test.ts (11.437 s)
PASS src/services/eventlog/lib/src/__tests__/windows-eventlog-lib.test.ts (16.556 s)
  ΓùÅ Console

    console.warn
      Warning: Anonymization enabled but no mappingFilePath configured. Anonymization mapping will not persist across restarts.

      436 |     if (this.options.anonymize && !this.options.mappingFilePath) {
      437 |       // Mapping persistence is optional but recommended
    > 438 |       console.warn(
          |               ^
      439 |         'Warning: Anonymization enabled but no mappingFilePath configured. ' +
      440 |         'Anonymization mapping will not persist across restarts.'
      441 |       );

      at WindowsEventLogLibrary.validateOptions (src/services/eventlog/lib/src/windows-eventlog-lib.ts:438:15)
      at new WindowsEventLogLibrary (src/services/eventlog/lib/src/windows-eventlog-lib.ts:217:10)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/windows-eventlog-lib.test.ts:29:17)

    console.warn
      Warning: Anonymization enabled but no mappingFilePath configured. Anonymization mapping will not persist across restarts.

      436 |     if (this.options.anonymize && !this.options.mappingFilePath) {
      437 |       // Mapping persistence is optional but recommended
    > 438 |       console.warn(
          |               ^
      439 |         'Warning: Anonymization enabled but no mappingFilePath configured. ' +
      440 |         'Anonymization mapping will not persist across restarts.'
      441 |       );

      at WindowsEventLogLibrary.validateOptions (src/services/eventlog/lib/src/windows-eventlog-lib.ts:438:15)
      at new WindowsEventLogLibrary (src/services/eventlog/lib/src/windows-eventlog-lib.ts:217:10)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/windows-eventlog-lib.test.ts:226:17)

    console.warn
      Warning: Anonymization enabled but no mappingFilePath configured. Anonymization mapping will not persist across restarts.

      436 |     if (this.options.anonymize && !this.options.mappingFilePath) {
      437 |       // Mapping persistence is optional but recommended
    > 438 |       console.warn(
          |               ^
      439 |         'Warning: Anonymization enabled but no mappingFilePath configured. ' +
      440 |         'Anonymization mapping will not persist across restarts.'
      441 |       );

      at WindowsEventLogLibrary.validateOptions (src/services/eventlog/lib/src/windows-eventlog-lib.ts:438:15)
      at new WindowsEventLogLibrary (src/services/eventlog/lib/src/windows-eventlog-lib.ts:217:10)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/windows-eventlog-lib.test.ts:440:17)

(node:46552) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 SIGTERM listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
(Use `node --trace-warnings ...` to show where the warning was created)
(node:46552) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 SIGINT listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
(node:65600) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 SIGTERM listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
(Use `node --trace-warnings ...` to show where the warning was created)
(node:65600) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 SIGINT listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
PASS src/__tests__/server.test.ts (18.42 s)
PASS src/services/eventlog/__tests__/provider.test.ts (23.195 s)
  ΓùÅ Console

    console.warn
      Warning: Anonymization enabled but no mappingFilePath configured. Anonymization mapping will not persist across restarts.

      436 |     if (this.options.anonymize && !this.options.mappingFilePath) {
      437 |       // Mapping persistence is optional but recommended
    > 438 |       console.warn(
          |               ^
      439 |         'Warning: Anonymization enabled but no mappingFilePath configured. ' +
      440 |         'Anonymization mapping will not persist across restarts.'
      441 |       );

      at WindowsEventLogLibrary.validateOptions (src/services/eventlog/lib/src/windows-eventlog-lib.ts:438:15)
      at new WindowsEventLogLibrary (src/services/eventlog/lib/src/windows-eventlog-lib.ts:217:10)
      at EventLogProvider.start (src/services/eventlog/provider.ts:146:22)
      at Object.<anonymous> (src/services/eventlog/__tests__/provider.test.ts:172:22)

FAIL src/__tests__/startup.test.ts (26.084 s)
  ΓùÅ Console

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:20.857Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.858Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.860Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.860Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.860Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.861Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.876Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.877Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:20.877Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.631Z","level":"info","service":"mcp-host","message":"Restarting services due to file changes","context":{"serviceCount":0,"services":[]}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.632Z","level":"info","service":"mcp-host","message":"Service restart cycle completed"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.667Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.669Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.670Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.670Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.744Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.745Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.747Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.747Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.771Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.771Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.772Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.773Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:22.774Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.774Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.775Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.775Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.775Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.775Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.781Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.781Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:22.781Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.459Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.460Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.460Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.460Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.477Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.477Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.478Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.478Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.514Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.514Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.515Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.516Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:24.517Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.517Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.518Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.518Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.518Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.518Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.520Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.520Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:24.521Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.966Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.967Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.967Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.967Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.979Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.979Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.980Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:25.980Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.008Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.008Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.009Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.009Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:26.010Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.011Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.011Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.011Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.012Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.012Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.015Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.015Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:26.015Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.570Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.571Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.571Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.571Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.582Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.582Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.582Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.582Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.612Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.612Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.613Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.613Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:27.615Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.615Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.615Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.615Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.615Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.616Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.619Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.619Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:27.619Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.246Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.246Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.247Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.247Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.264Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.265Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.265Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.265Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.291Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.291Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.292Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.292Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:29.293Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.293Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.294Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.294Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.294Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.294Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.296Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.296Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:29.296Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.807Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.807Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.808Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.808Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.821Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.822Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.822Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.822Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.849Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.849Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.850Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.850Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=development, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:30.851Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.852Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.852Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.852Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.852Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.852Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.856Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.857Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:30.857Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.621Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.621Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.621Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.621Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.643Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"development"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.643Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"development"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.644Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.644Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.699Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.699Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.700Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.701Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=production, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:32.702Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.703Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.703Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.703Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:32.703Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.938Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.938Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.938Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.938Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.warn
      Persisted queries are enabled and are using an unbounded cache. Your server is vulnerable to denial of service attacks via memory exhaustion. Set `cache: "bounded"` or `persistedQueries: false` in your ApolloServer constructor, or see https://go.apollo.dev/s/cache-backends for other alternatives.

      136 |
      137 |     // Initialize Apollo Server for GraphQL
    > 138 |     this.apolloServer = new ApolloServer({
          |                         ^
      139 |       typeDefs,
      140 |       resolvers: createResolvers(this.registry, this.logger),
      141 |       introspection: true,

      at new ApolloServerBase (node_modules/apollo-server-core/src/ApolloServer.ts:277:21)
      at new ApolloServer (node_modules/apollo-server-express/src/ApolloServer.ts:55:1)
      at ServerImpl.setupRoutes (src/server.ts:138:25)
      at ServerImpl.start (src/server.ts:211:5)
      at initializeApp (src/index.ts:72:5)
      at Object.<anonymous> (src/__tests__/startup.test.ts:91:19)

    console.log
      {"timestamp":"2026-02-09T22:48:33.961Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"production"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.961Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"production"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.962Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.962Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.962Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.963Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.963Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:33.965Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.965Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.966Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.966Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.967Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.967Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.968Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.968Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:33.969Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.561Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.561Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.561Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.562Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.577Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.577Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.577Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.577Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.622Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.623Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.624Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.624Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.624Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.625Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=development, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:35.626Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.626Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.626Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.627Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.627Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.627Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.629Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.629Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:35.630Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.193Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.193Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.193Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.193Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.205Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"development"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.206Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"development"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.347Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.347Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.385Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.385Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.386Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.386Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.386Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.387Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:37.388Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.389Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.389Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.390Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.390Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.390Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.399Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.400Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:37.400Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.778Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.778Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.778Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.778Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.792Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.792Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.792Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.792Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.815Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.815Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.816Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.816Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.816Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.816Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:38.818Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.818Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.818Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.819Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.819Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.819Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:38.820Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.821Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.821Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.821Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.821Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.821Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.823Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.823Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.824Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.828Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.828Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:38.828Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.858Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.858Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.859Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.859Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.870Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.870Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.873Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.873Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.873Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.873Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.883Z","level":"error","service":"mcp-host","message":"Server error","context":{"error":"listen EADDRINUSE: address already in use :::3000"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.883Z","level":"error","service":"mcp-host","message":"Failed to start server","context":{"error":"Error: listen EADDRINUSE: address already in use :::3000"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.883Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.883Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.886Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.886Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.886Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.886Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:39.888Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.888Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.888Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.888Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.888Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.889Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.891Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.891Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:39.891Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.306Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.306Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.306Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.306Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.315Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.315Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.315Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.316Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.316Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.316Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.316Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.316Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:41.318Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.318Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.318Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.318Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.318Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.318Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.319Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.319Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:41.320Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.300Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.300Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.300Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.301Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.310Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.310Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.310Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.311Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.311Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.311Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.311Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.311Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:42.312Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.313Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.313Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.313Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.313Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.313Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.315Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.315Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:42.315Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.294Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.294Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.295Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.295Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.304Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.304Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.305Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.305Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.311Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.311Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.312Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.312Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:43.313Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.313Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.313Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.314Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.314Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.314Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.314Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.315Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:43.315Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.381Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.382Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.382Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.382Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.391Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.391Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.391Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.391Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.397Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.397Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.398Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.398Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      Initializing MCP Host Bootstrap...

      at initializeApp (src/index.ts:30:11)

    console.log
      Loading environment configuration...

      at initializeApp (src/index.ts:33:11)

    console.log
      Configuration loaded: NODE_ENV=test, PORT=3000

      at initializeApp (src/index.ts:37:11)

    console.log
      {"timestamp":"2026-02-09T22:48:44.399Z","level":"info","service":"mcp-host","message":"Logger initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.399Z","level":"info","service":"mcp-host","message":"Creating Express server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.399Z","level":"info","service":"mcp-host","message":"Service registry initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.399Z","level":"info","service":"mcp-host","message":"Service lifecycle manager initialized"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.399Z","level":"info","service":"mcp-host","message":"Starting file watcher for development mode"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.399Z","level":"info","service":"mcp-host","message":"Starting file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.400Z","level":"info","service":"mcp-host","message":"File watcher ready and monitoring changes"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.400Z","level":"info","service":"mcp-host","message":"File watcher started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:44.400Z","level":"info","service":"mcp-host","message":"Starting HTTP server..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.369Z","level":"warn","service":"eventlog","message":"Healthcheck failed: no event logs available"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.370Z","level":"warn","service":"eventlog","message":"EventLog service healthcheck failed - proceeding with unverified service"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.370Z","level":"info","service":"eventlog","message":"EventLogProvider started successfully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.370Z","level":"info","service":"mcp-host","message":"EventLog provider started"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.379Z","level":"info","service":"mcp-host","message":"HTTP server started","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.379Z","level":"info","service":"mcp-host","message":"Server started successfully","context":{"port":3000,"mode":"test"}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.380Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.380Z","level":"info","service":"mcp-host","message":"Stopping file watcher"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.385Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.385Z","level":"info","service":"eventlog","message":"EventLogProvider stopped successfully","context":{"metrics":{"queriesExecuted":0,"queriesFailed":0,"totalResultsReturned":0,"totalExecutionTimeMs":0,"averageExecutionTimeMs":0}}}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.385Z","level":"info","service":"mcp-host","message":"Server closed gracefully"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.386Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.386Z","level":"info","service":"mcp-host","message":"Starting graceful shutdown..."}

      at StructuredLogger.log (src/logger/index.ts:105:13)

    console.log
      {"timestamp":"2026-02-09T22:48:45.386Z","level":"info","service":"mcp-host","message":"Application shutdown complete"}

      at StructuredLogger.log (src/logger/index.ts:105:13)

  ΓùÅ Application Startup and Shutdown ΓÇ║ error handling ΓÇ║ should log startup information

    listen EADDRINUSE: address already in use :::3000

      213 |     return new Promise((resolve, reject) => {
      214 |       try {
    > 215 |         this.httpServer = this.app.listen(this.config.port, () => {
          |                                    ^
      216 |           this.logger.info('HTTP server started', {
      217 |             port: this.config.port,
      218 |             mode: this.config.nodeEnv,

      at app.listen (node_modules/express/lib/application.js:635:24)
      at src/server.ts:215:36
      at ServerImpl.start (src/server.ts:213:12)
      at initializeApp (src/index.ts:72:5)
      at Object.<anonymous> (src/__tests__/startup.test.ts:149:17)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Summary of all failing tests
FAIL src/services/eventlog/__tests__/metrics.test.ts (5.192 s)
  ΓùÅ EventLogMetricsCollector ΓÇ║ recordQuery ΓÇ║ should reject non-numeric duration

    expect(received).toThrow()

    Received function did not throw

      83 |
      84 |     it('should reject non-numeric duration', () => {
    > 85 |       expect(() => collector.recordQuery(NaN, 10)).toThrow();
         |                                                    ^
      86 |     });
      87 |
      88 |     it('should reject negative result count', () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:85:52)

  ΓùÅ EventLogMetricsCollector ΓÇ║ recordQuery ΓÇ║ should reject non-numeric result count

    expect(received).toThrow()

    Received function did not throw

      91 |
      92 |     it('should reject non-numeric result count', () => {
    > 93 |       expect(() => collector.recordQuery(100, NaN)).toThrow();
         |                                                     ^
      94 |     });
      95 |
      96 |     it('should handle zero results', () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:93:53)

  ΓùÅ EventLogMetricsCollector ΓÇ║ reset ΓÇ║ should reset uptime for export

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      228 |       const after = await collector.export();
      229 |
    > 230 |       expect(before.uptimeMs).toBeGreaterThan(0);
          |                               ^
      231 |       expect(after.uptimeMs).toBeLessThan(before.uptimeMs);
      232 |     });
      233 |   });

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:230:31)

  ΓùÅ EventLogMetricsCollector ΓÇ║ export ΓÇ║ should calculate queriesPerSecond

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 10000
    Received:    Infinity

      257 |       // With 10 queries and some uptime, queriesPerSecond should be positive
      258 |       expect(report.queriesPerSecond).toBeGreaterThan(0);
    > 259 |       expect(report.queriesPerSecond).toBeLessThanOrEqual(10000); // Sanity check
          |                                       ^
      260 |     });
      261 |
      262 |     it('should calculate averageResultsPerQuery', async () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/metrics.test.ts:259:39)

FAIL src/graphql/__tests__/cursor.test.ts (6.875 s)
  ΓùÅ Cursor Utilities ΓÇ║ encodeCursor ΓÇ║ should encode a cursor position to base64

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:19:35)

  ΓùÅ Cursor Utilities ΓÇ║ encodeCursor ΓÇ║ should encode large event IDs

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:43:35)

  ΓùÅ Cursor Utilities ΓÇ║ decodeCursor ΓÇ║ should decode a valid base64 cursor

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:58:35)

  ΓùÅ Cursor Utilities ΓÇ║ decodeCursor ΓÇ║ should handle cursor with special characters

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:90:35)

  ΓùÅ Cursor Utilities ΓÇ║ isValidCursor ΓÇ║ should return true for valid cursor

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      104 |       const cursor = encodeCursor(position);
      105 |
    > 106 |       expect(isValidCursor(cursor)).toBe(true);
          |                                     ^
      107 |     });
      108 |
      109 |     it('should return false for invalid base64', () => {

      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:106:37)

  ΓùÅ Cursor Utilities ΓÇ║ Round-trip encoding/decoding ΓÇ║ should maintain data through encode/decode cycle

    Invalid cursor: Cursor contains invalid timestamp

      64 |   } catch (error) {
      65 |     const message = error instanceof Error ? error.message : String(error);
    > 66 |     throw new Error(`Invalid cursor: ${message}`);
         |           ^
      67 |   }
      68 | }
      69 |

      at decodeCursor (src/graphql/cursor.ts:66:11)
      at Object.<anonymous> (src/graphql/__tests__/cursor.test.ts:139:37)

FAIL src/logger/__tests__/logger.test.ts
  ΓùÅ Test suite failed to run

    src/logger/__tests__/logger.test.ts:388:8 - error TS2554: Expected 2 arguments, but got 3.

    388     }, 100);
               ~~~
    src/logger/__tests__/logger.test.ts:389:3 - error TS1128: Declaration or statement expected.

    389   });
          ~
    src/logger/__tests__/logger.test.ts:389:4 - error TS1128: Declaration or statement expected.

    389   });
           ~
    src/logger/__tests__/logger.test.ts:390:1 - error TS1128: Declaration or statement expected.

    390 });
        ~
    src/logger/__tests__/logger.test.ts:390:2 - error TS1128: Declaration or statement expected.

    390 });
         ~

FAIL src/mcp/__tests__/performance.test.ts
  ΓùÅ Test suite failed to run

    src/mcp/__tests__/performance.test.ts:15:1 - error TS6192: All imports in import declaration are unused.

    15 import { ProtocolHandler, JSON_RPC_ERRORS } from '../protocol-handler';
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:18:10 - error TS6133: 'Readable' is declared but its value is never read.

    18 import { Readable, Writable } from 'stream';
                ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:23:7 - error TS6196: 'MockWritable' is declared but never used.

    23 class MockWritable extends Writable {
             ~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:107:71 - error TS2554: Expected 1 arguments, but got 2.

    107       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    108         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    109         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    110       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:113:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    113       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:119:56 - error TS2554: Expected 1 arguments, but got 2.

    119       await toolExecutor.executeTool('eventlog_query', {
                                                               ~
    120         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    121         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    122       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:128:58 - error TS2554: Expected 1 arguments, but got 2.

    128         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    129           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    130           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    131         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:148:73 - error TS2554: Expected 1 arguments, but got 2.

    148         const result = await toolExecutor.executeTool('eventlog_query', params);
                                                                                ~~~~~~
    src/mcp/__tests__/performance.test.ts:151:23 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    151         expect(result.success).toBe(true);
                              ~~~~~~~
    src/mcp/__tests__/performance.test.ts:158:71 - error TS2554: Expected 1 arguments, but got 2.

    158       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    159         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    160         limit: 'invalid', // Invalid type
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    161       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:164:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    164       expect(result.success).toBe(false);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:182:32 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    182       const result = validator.validate({ logName: 'System', limit: 100 }, schema);
                                       ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:205:32 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    205       const result = validator.validate(
                                       ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:231:19 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    231         validator.validate({ logName: 'System', limit: 100 }, schema);
                          ~~~~~~~~
    src/mcp/__tests__/performance.test.ts:255:54 - error TS2554: Expected 1 arguments, but got 2.

    255           toolExecutor.executeTool('eventlog_query', {
                                                             ~
    256             logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    257             limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~
    258           })
        ~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:266:37 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    266       expect(results.every((r) => r.success === true)).toBe(true);
                                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:274:58 - error TS2554: Expected 1 arguments, but got 2.

    274         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    275           logName: i % 2 === 0 ? 'System' : 'Application',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    276           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    277         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:292:56 - error TS2554: Expected 1 arguments, but got 2.

    292             toolExecutor.executeTool('eventlog_query', {
                                                               ~
    293               logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    294               limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~~~
    295             })
        ~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:314:56 - error TS2554: Expected 1 arguments, but got 2.

    314             toolExecutor.executeTool('eventlog_query', {
                                                               ~
    315               logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    316               limit: 'invalid', // Error
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    317             })
        ~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:321:56 - error TS2554: Expected 1 arguments, but got 2.

    321             toolExecutor.executeTool('eventlog_query', {
                                                               ~
    322               logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    323               limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~~~
    324             })
        ~~~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:342:58 - error TS2554: Expected 1 arguments, but got 2.

    342         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    343           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    344           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    345         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:350:71 - error TS2554: Expected 1 arguments, but got 2.

    350       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    351         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    352         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    353       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:356:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    356       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:408:71 - error TS2554: Expected 1 arguments, but got 2.

    408       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    409         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    410         limit: 10000,
        ~~~~~~~~~~~~~~~~~~~~~
    411       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:414:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    414       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:420:71 - error TS2554: Expected 1 arguments, but got 2.

    420       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    421         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    423         offset: 50000,
        ~~~~~~~~~~~~~~~~~~~~~~
    424       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:427:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    427       expect(result.success === true || result.success === false).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:427:48 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    427       expect(result.success === true || result.success === false).toBe(true);
                                                       ~~~~~~~
    src/mcp/__tests__/performance.test.ts:437:58 - error TS2554: Expected 1 arguments, but got 2.

    437         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    438           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    439           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    440         });
        ~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:454:54 - error TS2554: Expected 1 arguments, but got 2.

    454           toolExecutor.executeTool('eventlog_query', {
                                                             ~
    455             logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    456             limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~
    457           })
        ~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:473:91 - error TS2554: Expected 1 arguments, but got 2.

    473           toolExecutor.executeTool(i % 2 === 0 ? 'eventlog_query' : 'eventlog_list_logs', {
                                                                                                  ~
    474             logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    475             limit: 10,
        ~~~~~~~~~~~~~~~~~~~~~~
    476           })
        ~~~~~~~~~~~
    src/mcp/__tests__/performance.test.ts:482:71 - error TS2554: Expected 1 arguments, but got 2.

    482       const result = await toolExecutor.executeTool('eventlog_query', {
                                                                              ~
    483         logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    484         limit: 10,
        ~~~~~~~~~~~~~~~~~~
    485       });
        ~~~~~~~
    src/mcp/__tests__/performance.test.ts:487:21 - error TS2339: Property 'success' does not exist on type 'ToolCallResponse'.

    487       expect(result.success).toBe(true);
                            ~~~~~~~
    src/mcp/__tests__/performance.test.ts:520:58 - error TS2554: Expected 1 arguments, but got 2.

    520         await toolExecutor.executeTool('eventlog_query', {
                                                                 ~
    521           logName: 'System',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    522           limit: 10,
        ~~~~~~~~~~~~~~~~~~~~
    523         });
        ~~~~~~~~~

FAIL src/services/eventlog/__tests__/machine-name-anonymization.test.ts
  ΓùÅ Test suite failed to run

    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:68:28 - error TS18048: 'anonymized.message' is possibly 'undefined'.

    68       const tokenMatches = anonymized.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/g);
                                  ~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:110:22 - error TS18048: 'anonymized.message' is possibly 'undefined'.

    110       const tokens = anonymized.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/g);
                             ~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:145:22 - error TS18048: 'anon1.message' is possibly 'undefined'.

    145       const token1 = anon1.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:146:22 - error TS18048: 'anon2.message' is possibly 'undefined'.

    146       const token2 = anon2.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:160:22 - error TS18048: 'anon1.message' is possibly 'undefined'.

    160       const token1 = anon1.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:170:22 - error TS18048: 'anon2.message' is possibly 'undefined'.

    170       const token2 = anon2.message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:202:22 - error TS18048: 'anonymized.message' is possibly 'undefined'.

    202       const tokens = anonymized.message.match(/\[ANON_/g) || [];
                             ~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:256:22 - error TS2532: Object is possibly 'undefined'.

    256       const token1 = anonymized[0].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:257:22 - error TS2532: Object is possibly 'undefined'.

    257       const token2 = anonymized[1].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~~~~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:258:13 - error TS6133: 'token3' is declared but its value is never read.

    258       const token3 = anonymized[2].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                    ~~~~~~
    src/services/eventlog/__tests__/machine-name-anonymization.test.ts:258:22 - error TS2532: Object is possibly 'undefined'.

    258       const token3 = anonymized[2].message.match(/\[ANON_COMPUTER_[A-F0-9]{6}\]/)?.[0];
                             ~~~~~~~~~~~~~~~~~~~~~

FAIL src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts
  ΓùÅ EventLogLibrary ΓÇ║ queryEventLog ΓÇ║ should cap maxResults at 10000

    TypeError: Cannot read properties of undefined (reading '0')

      158 |       await library.queryEventLog({ logName: 'System', maxResults: 99999 });
      159 |
    > 160 |       const call = (PowerShellModule.PowerShellExecutor.executeJson as jest.Mock).mock.calls[0][0];
          |                                                                                                ^
      161 |       expect(call).toContain('-MaxEvents 10000');
      162 |     });
      163 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts:160:96)

  ΓùÅ EventLogLibrary ΓÇ║ queryEventLog ΓÇ║ should calculate pagination metadata correctly

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      257 |       expect(result.success).toBe(true);
      258 |       expect(result.entries).toHaveLength(50);
    > 259 |       expect(result.hasNextPage).toBe(false);
          |                                  ^
      260 |       expect(result.nextOffset).toBeUndefined();
      261 |     });
      262 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts:259:34)

  ΓùÅ EventLogLibrary ΓÇ║ queryEventLog ΓÇ║ should calculate correct nextOffset with existing offset

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      297 |       const result = await library.queryEventLog({ logName: 'System', maxResults: 50, offset: 100 });
      298 |
    > 299 |       expect(result.hasNextPage).toBe(false);
          |                                  ^
      300 |       expect(result.nextOffset).toBeUndefined();
      301 |     });
      302 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/eventlog-library.test.ts:299:34)

FAIL src/graphql/__tests__/schema.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/schema.test.ts:21:30 - error TS2339: Property 'getValues' does not exist on type 'GraphQLNamedType'.
      Property 'getValues' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    21       expect(eventLevelType!.getValues().map(v => v.name)).toEqual([
                                    ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:21:46 - error TS7006: Parameter 'v' implicitly has an 'any' type.

    21       expect(eventLevelType!.getValues().map(v => v.name)).toEqual([
                                                    ~
    src/graphql/__tests__/schema.test.ts:35:33 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    35       const fields = entryType!.getFields();
                                       ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:52:36 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    52       const fields = pageInfoType!.getFields();
                                          ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:65:35 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    65       const fields = metricsType!.getFields();
                                         ~~~~~~~~~
    src/graphql/__tests__/schema.test.ts:77:34 - error TS2339: Property 'getFields' does not exist on type 'GraphQLNamedType'.
      Property 'getFields' does not exist on type 'GraphQLScalarType<unknown, unknown>'.

    77       const fields = resultType!.getFields();
                                        ~~~~~~~~~

FAIL src/mcp/__tests__/e2e-integration.test.ts
  ΓùÅ Test suite failed to run

    src/mcp/__tests__/e2e-integration.test.ts:9:27 - error TS6133: 'JSON_RPC_ERRORS' is declared but its value is never read.

    9 import { ProtocolHandler, JSON_RPC_ERRORS } from '../protocol-handler';
                                ~~~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:89:50 - error TS6133: 'params' is declared but its value is never read.

    89     handler.registerHandler('initialize', async (params: any) => {
                                                        ~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:108:58 - error TS2554: Expected 1 arguments, but got 2.

    108       return await toolExecutor.executeTool(params.name, params.arguments);
                                                                 ~~~~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:116:34 - error TS2554: Expected 2 arguments, but got 1.

    116       const initResponse = await initHandler({
                                         ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:116:34 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    116       const initResponse = await initHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:116:34 - error TS18048: 'initHandler' is possibly 'undefined'.

    116       const initResponse = await initHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:123:14 - error TS18046: 'initResponse' is of type 'unknown'.

    123       expect(initResponse.protocolVersion).toBe('2024-11-05');
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:124:14 - error TS18046: 'initResponse' is of type 'unknown'.

    124       expect(initResponse.capabilities).toBeDefined();
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:125:14 - error TS18046: 'initResponse' is of type 'unknown'.

    125       expect(initResponse.serverInfo).toBeDefined();
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:129:34 - error TS2554: Expected 2 arguments, but got 1.

    129       const listResponse = await listHandler({});
                                         ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:129:34 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    129       const listResponse = await listHandler({});
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:129:34 - error TS18048: 'listHandler' is possibly 'undefined'.

    129       const listResponse = await listHandler({});
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:131:14 - error TS18046: 'listResponse' is of type 'unknown'.

    131       expect(listResponse.tools).toBeDefined();
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:132:28 - error TS18046: 'listResponse' is of type 'unknown'.

    132       expect(Array.isArray(listResponse.tools)).toBe(true);
                                   ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:133:14 - error TS18046: 'listResponse' is of type 'unknown'.

    133       expect(listResponse.tools.length).toBeGreaterThan(0);
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:137:34 - error TS2554: Expected 2 arguments, but got 1.

    137       const callResponse = await callHandler({
                                         ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:137:34 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    137       const callResponse = await callHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:137:34 - error TS18048: 'callHandler' is possibly 'undefined'.

    137       const callResponse = await callHandler({
                                         ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:146:14 - error TS18046: 'callResponse' is of type 'unknown'.

    146       expect(callResponse.success).toBe(true);
                     ~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:151:30 - error TS2554: Expected 2 arguments, but got 1.

    151       const response = await initHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:151:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    151       const response = await initHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:151:30 - error TS18048: 'initHandler' is possibly 'undefined'.

    151       const response = await initHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:158:14 - error TS18046: 'response' is of type 'unknown'.

    158       expect(response.serverInfo.name).toBe('SysMCP');
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:159:14 - error TS18046: 'response' is of type 'unknown'.

    159       expect(response.serverInfo.version).toBe('1.0.0');
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:164:30 - error TS2554: Expected 2 arguments, but got 1.

    164       const response = await listHandler({});
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:164:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    164       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:164:30 - error TS18048: 'listHandler' is possibly 'undefined'.

    164       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:166:14 - error TS18046: 'response' is of type 'unknown'.

    166       expect(response.tools).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:167:21 - error TS18046: 'response' is of type 'unknown'.

    167       const tools = response.tools as any[];
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:177:30 - error TS2554: Expected 2 arguments, but got 1.

    177       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:177:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    177       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:177:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    177       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:186:14 - error TS18046: 'response' is of type 'unknown'.

    186       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:187:14 - error TS18046: 'response' is of type 'unknown'.

    187       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:192:30 - error TS2554: Expected 2 arguments, but got 1.

    192       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:192:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    192       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:192:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    192       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:197:14 - error TS18046: 'response' is of type 'unknown'.

    197       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:198:14 - error TS18046: 'response' is of type 'unknown'.

    198       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:222:34 - error TS2576: Property 'validate' does not exist on type 'SchemaValidator'. Did you mean to access the static member 'SchemaValidator.validate' instead?

    222         const result = validator.validate({ logName: 'System', limit: 10 }, tool.inputSchema);
                                         ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:246:30 - error TS2554: Expected 2 arguments, but got 1.

    246       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:246:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    246       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:246:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    246       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:257:14 - error TS18046: 'response' is of type 'unknown'.

    257       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:258:14 - error TS18046: 'response' is of type 'unknown'.

    258       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:263:30 - error TS2554: Expected 2 arguments, but got 1.

    263       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:263:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    263       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:263:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    263       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:270:14 - error TS18046: 'response' is of type 'unknown'.

    270       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:275:30 - error TS2554: Expected 2 arguments, but got 1.

    275       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:275:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    275       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:275:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    275       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:284:14 - error TS18046: 'response' is of type 'unknown'.

    284       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:285:21 - error TS18046: 'response' is of type 'unknown'.

    285       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:291:30 - error TS2554: Expected 2 arguments, but got 1.

    291       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:291:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    291       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:291:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    291       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:300:14 - error TS18046: 'response' is of type 'unknown'.

    300       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:307:30 - error TS2554: Expected 2 arguments, but got 1.

    307       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:307:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    307       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:307:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    307       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:316:14 - error TS18046: 'response' is of type 'unknown'.

    316       expect(response.success).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:317:21 - error TS18046: 'response' is of type 'unknown'.

    317       expect(typeof response.success).toBe('boolean');
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:318:14 - error TS18046: 'response' is of type 'unknown'.

    318       expect(response.data).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:323:30 - error TS2554: Expected 2 arguments, but got 1.

    323       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:323:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    323       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:323:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    323       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:331:14 - error TS18046: 'response' is of type 'unknown'.

    331       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:332:21 - error TS18046: 'response' is of type 'unknown'.

    332       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:339:30 - error TS2554: Expected 2 arguments, but got 1.

    339       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:339:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    339       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:339:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    339       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:347:14 - error TS18046: 'response' is of type 'unknown'.

    347       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:348:21 - error TS18046: 'response' is of type 'unknown'.

    348       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:355:30 - error TS2554: Expected 2 arguments, but got 1.

    355       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:355:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    355       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:355:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    355       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:364:14 - error TS18046: 'response' is of type 'unknown'.

    364       expect(response.success).toBe(true);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:365:21 - error TS18046: 'response' is of type 'unknown'.

    365       const data = (response.data as any);
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:373:30 - error TS2554: Expected 2 arguments, but got 1.

    373       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:373:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    373       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:373:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    373       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:378:14 - error TS18046: 'response' is of type 'unknown'.

    378       expect(response.success).toBe(false);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:379:14 - error TS18046: 'response' is of type 'unknown'.

    379       expect(response.error).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:384:30 - error TS2554: Expected 2 arguments, but got 1.

    384       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:384:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    384       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:384:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    384       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:392:14 - error TS18046: 'response' is of type 'unknown'.

    392       expect(response.success).toBe(false);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:393:14 - error TS18046: 'response' is of type 'unknown'.

    393       expect(response.error).toBeDefined();
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:398:30 - error TS2554: Expected 2 arguments, but got 1.

    398       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:398:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    398       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:398:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    398       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:403:14 - error TS18046: 'response' is of type 'unknown'.

    403       expect(response.success).toBe(false);
                     ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:410:35 - error TS2554: Expected 2 arguments, but got 1.

    410       const errorResponse = await callHandler({
                                          ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:410:35 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    410       const errorResponse = await callHandler({
                                          ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:410:35 - error TS18048: 'callHandler' is possibly 'undefined'.

    410       const errorResponse = await callHandler({
                                          ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:418:14 - error TS18046: 'errorResponse' is of type 'unknown'.

    418       expect(errorResponse.success).toBe(false);
                     ~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:421:37 - error TS2554: Expected 2 arguments, but got 1.

    421       const successResponse = await callHandler({
                                            ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:421:37 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    421       const successResponse = await callHandler({
                                            ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:421:37 - error TS18048: 'callHandler' is possibly 'undefined'.

    421       const successResponse = await callHandler({
                                            ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:429:14 - error TS18046: 'successResponse' is of type 'unknown'.

    429       expect(successResponse.success).toBe(true);
                     ~~~~~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:444:32 - error TS2554: Expected 2 arguments, but got 1.

    444         const response = await callHandler({
                                       ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:444:32 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    444         const response = await callHandler({
                                       ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:444:32 - error TS18048: 'callHandler' is possibly 'undefined'.

    444         const response = await callHandler({
                                       ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:455:30 - error TS2554: Expected 2 arguments, but got 1.

    455       const response = await listHandler({});
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:455:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    455       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:455:30 - error TS18048: 'listHandler' is possibly 'undefined'.

    455       const response = await listHandler({});
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:457:21 - error TS18046: 'response' is of type 'unknown'.

    457       const tools = response.tools as any[];
                            ~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:471:31 - error TS2554: Expected 2 arguments, but got 1.

    471       const response1 = await callHandler({
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:471:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    471       const response1 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:471:31 - error TS18048: 'callHandler' is possibly 'undefined'.

    471       const response1 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:476:14 - error TS18046: 'response1' is of type 'unknown'.

    476       expect(response1.success).toBe(true);
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:479:31 - error TS2554: Expected 2 arguments, but got 1.

    479       const response2 = await callHandler({
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:479:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    479       const response2 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:479:31 - error TS18048: 'callHandler' is possibly 'undefined'.

    479       const response2 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:487:14 - error TS18046: 'response2' is of type 'unknown'.

    487       expect(response2.success).toBe(true);
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:490:31 - error TS2554: Expected 2 arguments, but got 1.

    490       const response3 = await callHandler({
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:490:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    490       const response3 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:490:31 - error TS18048: 'callHandler' is possibly 'undefined'.

    490       const response3 = await callHandler({
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:498:14 - error TS18046: 'response3' is of type 'unknown'.

    498       expect(response3.success).toBe(true);
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:504:31 - error TS2554: Expected 2 arguments, but got 1.

    504       const response1 = await listHandler({});
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:504:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    504       const response1 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:504:31 - error TS18048: 'listHandler' is possibly 'undefined'.

    504       const response1 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:505:31 - error TS2554: Expected 2 arguments, but got 1.

    505       const response2 = await listHandler({});
                                      ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:505:31 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    505       const response2 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:505:31 - error TS18048: 'listHandler' is possibly 'undefined'.

    505       const response2 = await listHandler({});
                                      ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:507:14 - error TS18046: 'response1' is of type 'unknown'.

    507       expect(response1.tools).toBeDefined();
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:508:14 - error TS18046: 'response2' is of type 'unknown'.

    508       expect(response2.tools).toBeDefined();
                     ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:509:15 - error TS18046: 'response1' is of type 'unknown'.

    509       expect((response1.tools as any[]).length).toBe((response2.tools as any[]).length);
                      ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:509:55 - error TS18046: 'response2' is of type 'unknown'.

    509       expect((response1.tools as any[]).length).toBe((response2.tools as any[]).length);
                                                              ~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:527:30 - error TS2554: Expected 2 arguments, but got 1.

    527       const response = await callHandler({
                                     ~~~~~~~~~~~

      src/mcp/message-types.ts:188:3
        188   requestId: string | number | null
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        An argument for 'requestId' was not provided.
    src/mcp/__tests__/e2e-integration.test.ts:527:30 - error TS2722: Cannot invoke an object which is possibly 'undefined'.

    527       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:527:30 - error TS18048: 'callHandler' is possibly 'undefined'.

    527       const response = await callHandler({
                                     ~~~~~~~~~~~
    src/mcp/__tests__/e2e-integration.test.ts:536:14 - error TS18046: 'response' is of type 'unknown'.

    536       expect(response.success).toBe(true);
                     ~~~~~~~~

FAIL src/services/eventlog/lib/src/__tests__/anonymizer.test.ts
  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should anonymize DOMAIN\username format

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      61 |
      62 |       const result = anonymizer.anonymizeEntry(entry);
    > 63 |       expect(result.userId).toContain('[ANON_USER_');
         |                             ^
      64 |       expect(result.userId).not.toContain('jsmith');
      65 |       expect(result.userId).not.toContain('CONTOSO\\jsmith');
      66 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:63:29)

  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should handle username in message

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      72 |
      73 |       const result = anonymizer.anonymizeEntry(entry);
    > 74 |       expect(result.message).toContain('[ANON_USER_');
         |                              ^
      75 |       expect(result.message).not.toContain('employee123');
      76 |       expect(result.message).toContain('logged in');
      77 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:74:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should handle multiple usernames in same field

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: undefined

      83 |
      84 |       const result = anonymizer.anonymizeEntry(entry);
    > 85 |       expect(result.message?.match(/\[ANON_USER_/g)?.length).toBe(2);
         |                                                              ^
      86 |       expect(result.message).not.toContain('user1');
      87 |       expect(result.message).not.toContain('user2');
      88 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:85:62)

  ΓùÅ PiiAnonymizer ΓÇ║ Username Anonymization ΓÇ║ should handle usernames with various formats

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      100 |         const result = anonymizer.anonymizeEntry(entry);
      101 |         expect(result.userId).not.toContain('\\');
    > 102 |         expect(result.userId).toContain('[ANON_USER_');
          |                               ^
      103 |       });
      104 |     });
      105 |   });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:102:31
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:98:17)

  ΓùÅ PiiAnonymizer ΓÇ║ Computer Name Anonymization ΓÇ║ should not anonymize regular words that are not computer names

    expect(received).toContain(expected) // indexOf

    Expected substring: "system"
    Received string:    "[ANON_COMPUTER_87EF56]"

      132 |       const result = anonymizer.anonymizeEntry(entry);
      133 |       // Common lowercase words should not be anonymized
    > 134 |       expect(result.message).toContain('system');
          |                              ^
      135 |       expect(result.message).toContain('processed');
      136 |     });
      137 |   });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:134:30)

  ΓùÅ PiiAnonymizer ΓÇ║ IPv4 Address Anonymization ΓÇ║ should anonymize IPv4 addresses

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_IP_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      152 |
      153 |         const result = anonymizer.anonymizeEntry(entry);
    > 154 |         expect(result.message).toContain('[ANON_IP_');
          |                                ^
      155 |         expect(result.message).not.toContain(ip);
      156 |       });
      157 |     });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:154:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:148:21)

  ΓùÅ PiiAnonymizer ΓÇ║ IPv4 Address Anonymization ΓÇ║ should handle multiple IPs in same message

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: undefined

      163 |
      164 |       const result = anonymizer.anonymizeEntry(entry);
    > 165 |       expect(result.message?.match(/\[ANON_IP_/g)?.length).toBe(2);
          |                                                            ^
      166 |     });
      167 |   });
      168 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:165:60)

  ΓùÅ PiiAnonymizer ΓÇ║ IPv6 Address Anonymization ΓÇ║ should anonymize IPv6 addresses

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_IP_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      182 |
      183 |         const result = anonymizer.anonymizeEntry(entry);
    > 184 |         expect(result.message).toContain('[ANON_IP_');
          |                                ^
      185 |         expect(result.message).not.toContain(ip);
      186 |       });
      187 |     });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:184:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:178:21)

  ΓùÅ PiiAnonymizer ΓÇ║ Email Address Anonymization ΓÇ║ should anonymize email addresses

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_EMAIL_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      203 |
      204 |         const result = anonymizer.anonymizeEntry(entry);
    > 205 |         expect(result.message).toContain('[ANON_EMAIL_');
          |                                ^
      206 |         expect(result.message).not.toContain('@');
      207 |         expect(result.message).not.toContain(email);
      208 |       });

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:205:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:199:18)

  ΓùÅ PiiAnonymizer ΓÇ║ Email Address Anonymization ΓÇ║ should handle multiple emails in same message

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: undefined

      215 |
      216 |       const result = anonymizer.anonymizeEntry(entry);
    > 217 |       expect(result.message?.match(/\[ANON_EMAIL_/g)?.length).toBe(2);
          |                                                               ^
      218 |     });
      219 |   });
      220 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:217:63)

  ΓùÅ PiiAnonymizer ΓÇ║ File Path Anonymization ΓÇ║ should anonymize Windows user profile paths

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      236 |         expect(result.message).not.toContain('admin');
      237 |         expect(result.message).not.toContain('operator');
    > 238 |         expect(result.message).toContain('[ANON_USER_');
          |                                ^
      239 |       });
      240 |     });
      241 |

      at src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:238:32
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:229:17)

  ΓùÅ PiiAnonymizer ΓÇ║ File Path Anonymization ΓÇ║ should preserve path structure when anonymizing

    expect(received).toContain(expected) // indexOf

    Expected substring: "C:\\Users\\"
    Received string:    "[ANON_COMPUTER_87EF56]"

      246 |
      247 |       const result = anonymizer.anonymizeEntry(entry);
    > 248 |       expect(result.message).toContain('C:\\Users\\');
          |                              ^
      249 |       expect(result.message).toContain('\\Documents\\file.txt');
      250 |     });
      251 |   });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:248:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Mixed PII in Single Message ΓÇ║ should anonymize multiple PII types in one message

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      266 |       
      267 |       // Check anonymization tokens exist
    > 268 |       expect(result.message).toContain('[ANON_USER_');
          |                              ^
      269 |       expect(result.message).toContain('[ANON_EMAIL_');
      270 |       expect(result.message).toContain('[ANON_IP_');
      271 |       expect(result.message).toContain('[ANON_COMPUTER_');

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:268:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Consistency (Deterministic Hashing) ΓÇ║ should maintain consistency across multiple queries

    expect(received).toEqual(expected) // deep equality

    Expected: undefined
    Received: "[ANON_COMPUTER_87EF56]"

      297 |       expect(result1.userId).toBe(result2.userId);
      298 |       // And the username in message should also match
    > 299 |       expect(result1.userId).toEqual(
          |                              ^
      300 |         result2.message?.match(/\[ANON_USER_[^\]]+\]/)?.[0]
      301 |       );
      302 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:299:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Consistency (Deterministic Hashing) ΓÇ║ should produce different tokens for different inputs

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not "[ANON_COMPUTER_87EF56]"

      309 |       const result2 = anonymizer.anonymizeEntry(entry2);
      310 |
    > 311 |       expect(result1.userId).not.toBe(result2.userId);
          |                                  ^
      312 |     });
      313 |   });
      314 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:311:34)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle null values

    expect(received).toBe(expected) // Object.is equality

    Expected: "Test message"
    Received: "[ANON_COMPUTER_87EF56]"

      322 |       const result = anonymizer.anonymizeEntry(entry);
      323 |       expect(result.userId).toBeNull();
    > 324 |       expect(result.message).toBe('Test message');
          |                              ^
      325 |     });
      326 |
      327 |     it('should handle empty strings', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:324:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle empty strings

    expect(received).toBe(expected) // Object.is equality

    Expected: "Test"
    Received: "[ANON_COMPUTER_87EF56]"

      333 |       const result = anonymizer.anonymizeEntry(entry);
      334 |       expect(result.userId).toBe('');
    > 335 |       expect(result.message).toBe('Test');
          |                              ^
      336 |     });
      337 |
      338 |     it('should handle undefined values', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:335:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle undefined values

    expect(received).toBe(expected) // Object.is equality

    Expected: "Test message"
    Received: "[ANON_COMPUTER_87EF56]"

      342 |
      343 |       const result = anonymizer.anonymizeEntry(entry);
    > 344 |       expect(result.message).toBe('Test message');
          |                              ^
      345 |       expect(result.userId).toBeUndefined();
      346 |     });
      347 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:344:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle non-string fields

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      358 |       expect(result.eventId).toBe(456);
      359 |       expect(result.timeCreated).toEqual(new Date('2024-01-01'));
    > 360 |       expect(result.message).toContain('[ANON_USER_');
          |                              ^
      361 |     });
      362 |
      363 |     it('should handle strings with no PII', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:360:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Edge Cases ΓÇ║ should handle strings with no PII

    expect(received).toBe(expected) // Object.is equality

    Expected: "System startup completed successfully"
    Received: "[ANON_COMPUTER_87EF56]"

      367 |
      368 |       const result = anonymizer.anonymizeEntry(entry);
    > 369 |       expect(result.message).toBe('System startup completed successfully');
          |                              ^
      370 |     });
      371 |
      372 |     it('should handle malformed data gracefully', () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:369:30)

  ΓùÅ PiiAnonymizer ΓÇ║ Mapping Persistence ΓÇ║ should load mapping from file

    expect(received).toBeDefined()

    Received: undefined

      408 |       // Load and verify
      409 |       const loaded = await PiiAnonymizer.loadMapping(mappingFile);
    > 410 |       expect(loaded.usernames.get('DOMAIN\\jsmith')).toBeDefined();
          |                                                      ^
      411 |     });
      412 |
      413 |     it('should maintain consistency after reload', async () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:410:54)

  ΓùÅ PiiAnonymizer ΓÇ║ Mapping Persistence ΓÇ║ should maintain consistency after reload

    expect(received).toBe(expected) // Object.is equality

    Expected: undefined
    Received: "[ANON_COMPUTER_87EF56]"

      426 |       const entry = { userId: 'DOMAIN\\jsmith' };
      427 |       const result = anonymizer2.anonymizeEntry(entry);
    > 428 |       expect(result.userId).toBe(token1);
          |                             ^
      429 |     });
      430 |
      431 |     it('should handle missing file gracefully', async () => {

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:428:29)

  ΓùÅ PiiAnonymizer ΓÇ║ getMapping() ΓÇ║ should return current mapping

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      481 |       
      482 |       const mapping = anonymizer.getMapping();
    > 483 |       expect(mapping.usernames.size).toBe(1);
          |                                      ^
      484 |       expect(mapping.usernames.has('DOMAIN\\user1')).toBe(true);
      485 |     });
      486 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:483:38)

  ΓùÅ PiiAnonymizer ΓÇ║ getMapping() ΓÇ║ should allow inspection of all mapping types

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      493 |
      494 |       const mapping = anonymizer.getMapping();
    > 495 |       expect(mapping.usernames.size).toBeGreaterThan(0);
          |                                      ^
      496 |       expect(mapping.computerNames.size).toBeGreaterThan(0);
      497 |       expect(mapping.emails.size).toBeGreaterThan(0);
      498 |     });

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:495:38)

  ΓùÅ PiiAnonymizer ΓÇ║ Real-World Scenarios ΓÇ║ should handle typical Windows event log entry

    expect(received).toContain(expected) // indexOf

    Expected substring: "[ANON_USER_"
    Received string:    "[ANON_COMPUTER_87EF56]"

      528 |
      529 |       // Verify anonymization tokens exist
    > 530 |       expect(result.message).toContain('[ANON_USER_');
          |                              ^
      531 |       expect(result.message).toContain('[ANON_IP_');
      532 |     });
      533 |

      at Object.<anonymous> (src/services/eventlog/lib/src/__tests__/anonymizer.test.ts:530:30)

FAIL src/mcp/__tests__/protocol-handler.test.ts (8.07 s)
  ΓùÅ ProtocolHandler ΓÇ║ Initialization ΓÇ║ prevents tools/list before initialization

    expect(received).toBeDefined()

    Received: undefined

      513 |
      514 |       const response = JSON.parse(mockOutput.output[0]);
    > 515 |       expect(response.error).toBeDefined();
          |                              ^
      516 |       expect(response.error.code).toBe(-32002);
      517 |     });
      518 |

      at Object.<anonymous> (src/mcp/__tests__/protocol-handler.test.ts:515:30)

FAIL src/graphql/__tests__/eventlog.performance.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.performance.test.ts:15:1 - error TS6133: 'EventLevel' is declared but its value is never read.

    15 import { EventLevel } from '../../services/eventlog/types';
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.performance.test.ts:141:28 - error TS2339: Property 'mockClear' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    141         mockProvider.query.mockClear();
                                   ~~~~~~~~~
    src/graphql/__tests__/eventlog.performance.test.ts:142:28 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    142         mockProvider.query.mockResolvedValue({
                                   ~~~~~~~~~~~~~~~~~

FAIL src/graphql/__tests__/eventlog.resolver.metrics.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:11:1 - error TS6133: 'EventLevel' is declared but its value is never read.

    11 import { EventLevel } from '../../services/eventlog/types';
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:43:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    43       mockProvider.query.mockResolvedValue({
                                ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:72:26 - error TS2339: Property 'mockRejectedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    72       mockProvider.query.mockRejectedValue(new Error('Query failed'));
                                ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:92:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    92       mockProvider.query.mockResolvedValue({
                                ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:130:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    130       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:164:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    164       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:192:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    192       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:224:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    224       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:243:26 - error TS2339: Property 'mockImplementation' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    243       mockProvider.query.mockImplementation(
                                 ~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:267:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    267       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:289:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    289       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.metrics.test.ts:354:26 - error TS2339: Property 'mockResolvedValue' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    354       mockProvider.query.mockResolvedValue({
                                 ~~~~~~~~~~~~~~~~~

FAIL src/services/eventlog/__tests__/anonymization-store.test.ts (8.257 s)
  ΓùÅ AnonymizationStore ΓÇ║ Error Handling ΓÇ║ should handle concurrent save operations safely

    ENOENT: no such file or directory, rename 'C:\Users\chris\Code\SysMCP\src\services\eventlog\__tests__\test-store-1770677299455\mapping.json.tmp' -> 'C:\Users\chris\Code\SysMCP\src\services\eventlog\__tests__\test-store-1770677299455\mapping.json'



FAIL src/services/__tests__/lifecycle.test.ts
  ΓùÅ Test suite failed to run

    src/services/__tests__/lifecycle.test.ts:8:1 - error TS6133: 'ServiceConfig' is declared but its value is never read.

    8 import { ServiceConfig } from '../types';
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL src/__tests__/watcher.test.ts
  ΓùÅ Test suite failed to run

    src/__tests__/watcher.test.ts:63:13 - error TS6133: 'startPromise' is declared but its value is never read.

    63       const startPromise = watcher.start();
                   ~~~~~~~~~~~~
    src/__tests__/watcher.test.ts:172:13 - error TS6133: 'startPromise' is declared but its value is never read.

    172       const startPromise = watcher.start();
                    ~~~~~~~~~~~~
    src/__tests__/watcher.test.ts:204:13 - error TS6133: 'startPromise' is declared but its value is never read.

    204       const startPromise = watcher.start();
                    ~~~~~~~~~~~~

FAIL src/graphql/__tests__/eventlog.resolver.anonymization.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.resolver.anonymization.test.ts:8:1 - error TS6133: 'PiiAnonymizer' is declared but its value is never read.

    8 import { PiiAnonymizer } from '../../services/eventlog/lib/src/anonymizer';
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL src/graphql/__tests__/eventlog.resolver.test.ts
  ΓùÅ Test suite failed to run

    src/graphql/__tests__/eventlog.resolver.test.ts:8:1 - error TS6133: 'EventLevel' is declared but its value is never read.

    8 import { EventLevel } from '../../services/eventlog/types';
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:248:28 - error TS2339: Property 'mockClear' does not exist on type '(query: EventLogQuery) => Promise<EventLogProviderResult>'.

    248         mockProvider.query.mockClear();
                                   ~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:731:7 - error TS2304: Cannot find name 'mockProvider'.

    731       mockProvider.query = jest.fn().mockResolvedValue({
              ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:737:71 - error TS2304: Cannot find name 'context'.

    737       await eventLogsResolver(null, { logName: 'System', offset: 0 }, context);
                                                                              ~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:739:14 - error TS2304: Cannot find name 'mockProvider'.

    739       expect(mockProvider.query).toHaveBeenCalledWith(
                     ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:750:7 - error TS2304: Cannot find name 'mockProvider'.

    750       mockProvider.query = jest.fn().mockResolvedValue({
              ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:756:72 - error TS2304: Cannot find name 'context'.

    756       await eventLogsResolver(null, { logName: 'System', limit: 100 }, context);
                                                                               ~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:758:14 - error TS2304: Cannot find name 'mockProvider'.

    758       expect(mockProvider.query).toHaveBeenCalledWith(
                     ~~~~~~~~~~~~
    src/graphql/__tests__/eventlog.resolver.test.ts:768:1 - error TS1128: Declaration or statement expected.

    768 });
        ~
    src/graphql/__tests__/eventlog.resolver.test.ts:768:2 - error TS1128: Declaration or statement expected.

    768 });
         ~

FAIL src/config/config.test.ts
  ΓùÅ Test suite failed to run

    src/config/config.test.ts:1:10 - error TS2459: Module '"../index"' declares 'createConfig' locally, but it is not exported.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
               ~~~~~~~~~~~~

      src/index.ts:6:10
        6 import { createConfig, Config } from './config';
                   ~~~~~~~~~~~~
        'createConfig' is declared here.
    src/config/config.test.ts:1:24 - error TS2305: Module '"../index"' has no exported member 'isDevelopment'.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                             ~~~~~~~~~~~~~
    src/config/config.test.ts:1:39 - error TS2305: Module '"../index"' has no exported member 'isProduction'.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                                            ~~~~~~~~~~~~
    src/config/config.test.ts:1:53 - error TS2459: Module '"../index"' declares 'Config' locally, but it is not exported.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                                                          ~~~~~~

      src/index.ts:6:24
        6 import { createConfig, Config } from './config';
                                 ~~~~~~
        'Config' is declared here.
    src/config/config.test.ts:1:53 - error TS6133: 'Config' is declared but its value is never read.

    1 import { createConfig, isDevelopment, isProduction, Config } from '../index';
                                                          ~~~~~~

FAIL src/services/eventlog/__tests__/eventlog.integration.test.ts
  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Basic Query Pipeline ΓÇ║ should query system log with no filters and return anonymized entries

    expect(received).toBe(expected) // Object.is equality

    Expected: "System startup"
    Received: "[ANON_COMPUTER_87EF56]"

      100 |
      101 |       // Verify anonymization
    > 102 |       expect(result.entries[0].message).toBe('System startup');
          |                                         ^
      103 |       expect(result.entries[1].message).not.toContain('DOMAIN\\user');
      104 |       expect(result.entries[1].username).not.toBe('DOMAIN\\user');
      105 |     });

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:102:41)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Filtered Queries ΓÇ║ should apply message filter correctly

    expect(received).toContain(expected) // indexOf

    Expected substring: "performed"
    Received string:    "[ANON_COMPUTER_87EF56]"

      309 |       expect(result.entries.length).toBe(1);
      310 |       // Verify message still matches the filter (even if PII is anonymized)
    > 311 |       expect(result.entries[0].message).toContain('performed');
          |                                         ^
      312 |     });
      313 |
      314 |     it('should apply multiple filters together', async () => {

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:311:41)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Consistency Across Queries ΓÇ║ should maintain consistency with same PII appearing in different entries

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not "[ANON_COMPUTER_87EF56]"

      513 |       const computer1 = result.entries[0].computername;
      514 |       const computer2 = result.entries[1].computername;
    > 515 |       expect(computer1).not.toBe(computer2);
          |                             ^
      516 |     });
      517 |   });
      518 |

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:515:29)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Error Cases ΓÇ║ should handle invalid parameters

    expect(received).rejects.toThrow(expected)

    Expected substring: "limit must be between 1 and 10000"
    Received message:   "limit must be between 1 and 1000"

          51 |     internalDetails?: string
          52 |   ) {
        > 53 |     super(message, {
             |     ^
          54 |       extensions: {
          55 |         code,
          56 |         timestamp: new Date().toISOString()

      at new EventLogGraphQLError (src/graphql/eventlog.resolver.ts:53:5)
      at validateArgs (src/graphql/eventlog.resolver.ts:171:11)
      at eventLogsResolver (src/graphql/eventlog.resolver.ts:244:5)
      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:551:39)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:557:36)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Metrics Collection ΓÇ║ should collect correct metrics

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      601 |       );
      602 |
    > 603 |       expect(result.metrics.queryCount).toBe(1);
          |                                         ^
      604 |       expect(result.metrics.resultsReturned).toBe(25);
      605 |       expect(result.metrics.responseDurationMs).toBeGreaterThanOrEqual(0);
      606 |     });

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:603:41)

  ΓùÅ EventLog GraphQL Resolver - Integration Tests ΓÇ║ Audit Logging ΓÇ║ should log errors with appropriate detail

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "EventLog query failed", ObjectContaining {"logName": "System"}
    Received: "Unknown error during EventLog query", {"durationMs": 0, "error": "Test error", "logName": "System", "stack": "Error: Test error

      671 |     it('should log errors with appropriate detail', async () => {
      672 |       mockProvider.query = jest.fn().mockRejectedValue(
    > 673 |         new Error('Test error')
          |         ^
      674 |       );
      675 |
      676 |       try {

      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:673:9)
      Number of calls: 1
      at Object.<anonymous> (src/services/eventlog/__tests__/eventlog.integration.test.ts:686:32)

FAIL src/services/eventlog/__tests__/anonymization.security.test.ts
  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Domain\username format

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "jsmith"
    Received string:        "CONTOSO\\jsmith"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Domain with dots

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "john.doe"
    Received string:        "corp.example\\john.doe"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Email-style username

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user@domain.com"
    Received string:        "user@domain.com"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Administrator account

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "Administrator"
    Received string:        "Administrator"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize System account

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "SYSTEM"
    Received string:        "SYSTEM"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Service account

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "svc_account"
    Received string:        "DOMAIN\\svc_account"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Username Anonymization Security ΓÇ║ should anonymize Numeric suffix username

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user123"
    Received string:        "DOMAIN\\user123"

      117 |         // Verify username is anonymized
      118 |         testCase.shouldNotContain.forEach(pattern => {
    > 119 |           expect(entry.username).not.toContain(pattern);
          |                                      ^
      120 |           expect(entry.message).not.toContain(pattern);
      121 |         });
      122 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:119:38
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:118:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Standard computer name

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "WORKSTATION1"
    Received string:        "WORKSTATION1"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Server naming pattern

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "SERVER-APP-01"
    Received string:        "SERVER-APP-01"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Laptop naming pattern

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "LAPTOP-JSMITH"
    Received string:        "LAPTOP-JSMITH"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Database server

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "DB-PROD-01"
    Received string:        "DB-PROD-01"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Computer Name Anonymization Security ΓÇ║ should anonymize Domain computer

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "CORP-PC-001"
    Received string:        "CORP-PC-001"

      190 |
      191 |         testCase.shouldNotContain.forEach(pattern => {
    > 192 |           expect(entry.computername).not.toContain(pattern);
          |                                          ^
      193 |           expect(entry.message).not.toContain(pattern);
      194 |         });
      195 |

      at src/services/eventlog/__tests__/anonymization.security.test.ts:192:42
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:191:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize IPv4 address

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "192.168.1.100"
    Received string:        "Login from 192.168.1.100"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize Localhost IPv4

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "127.0.0.1"
    Received string:        "Login from 127.0.0.1"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize Private network range

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "10.0.0.50"
    Received string:        "Login from 10.0.0.50"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize IPv6 address

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "2001:db8::1"
    Received string:        "Login from 2001:db8::1"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ IP Address Anonymization Security ΓÇ║ should anonymize IPv6 localhost

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "::1"
    Received string:        "Login from ::1"

      262 |
      263 |         testCase.shouldNotContain.forEach(pattern => {
    > 264 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      265 |         });
      266 |       });
      267 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:264:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:263:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Corporate email

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "john.smith@company.com"
    Received string:        "Email notification sent to john.smith@company.com"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Email with plus addressing

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user+test@example.com"
    Received string:        "Email notification sent to user+test@example.com"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Domain-local email

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "admin@corp.local"
    Received string:        "Email notification sent to admin@corp.local"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Email Address Anonymization Security ΓÇ║ should anonymize Email with numbers

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user123@example.com"
    Received string:        "Email notification sent to user123@example.com"

      326 |
      327 |         testCase.shouldNotContain.forEach(pattern => {
    > 328 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      329 |         });
      330 |       });
      331 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:328:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:327:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ File Path Anonymization Security ΓÇ║ should anonymize Windows user profile path

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "jsmith"
    Received string:        "File access: C:\\Users\\jsmith\\Documents"

      385 |
      386 |         testCase.shouldNotContain.forEach(pattern => {
    > 387 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      388 |         });
      389 |       });
      390 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:387:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:386:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ File Path Anonymization Security ΓÇ║ should anonymize User AppData path

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "user"
    Received string:        "File access: C:\\Users\\user\\AppData\\Local"

      385 |
      386 |         testCase.shouldNotContain.forEach(pattern => {
    > 387 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      388 |         });
      389 |       });
      390 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:387:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:386:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ File Path Anonymization Security ΓÇ║ should anonymize Shared network path

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "john"
    Received string:        "File access: \\\\SERVER\\Share\\Users\\john"

      385 |
      386 |         testCase.shouldNotContain.forEach(pattern => {
    > 387 |           expect(entry.message).not.toContain(pattern);
          |                                     ^
      388 |         });
      389 |       });
      390 |     });

      at src/services/eventlog/__tests__/anonymization.security.test.ts:387:37
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:386:35)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Embedded PII in Messages ΓÇ║ should anonymize multiple PII instances in single message

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "jsmith"
    Received string:        "User DOMAIN\\jsmith from WORKSTATION1 at 192.168.1.100 tried to access share from SERVER1"

      425 |
      426 |       // Verify no original PII in message
    > 427 |       expect(entry.message).not.toContain('jsmith');
          |                                 ^
      428 |       expect(entry.message).not.toContain('WORKSTATION1');
      429 |       expect(entry.message).not.toContain('192.168.1.100');
      430 |       expect(entry.message).not.toContain('SERVER1');

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:427:33)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Embedded PII in Messages ΓÇ║ should handle repeated PII values with consistent anonymization

    expect(received).not.toBeNull()

    Received: null

      471 |       // Extract anonymized username from first occurrence
      472 |       const match = entry.message.match(/ANON_USER_[a-zA-Z0-9]+/);
    > 473 |       expect(match).not.toBeNull();
          |                         ^
      474 |
      475 |       const anonUsername = match![0];
      476 |

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:473:25)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Realistic Event Log Scenarios ΓÇ║ should anonymize successful login event

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "JSmith"
    Received string:        "An account was successfully logged on.
    Subject:
    	Security ID:		S-1-5-18
    	Account Name:		CONTOSO\\\\JSmith

    Logon Information:
    	Logon Type:		3
    	Restricted Admin Mode:	-
    	Virtual Account:		No
    	Elevated Token:		No

    Impersonation Level:		Impersonation

    New Logon:
    	Security ID:		S-1-5-21-3623811015-3361044348-30300820-1013
    	Account Name:		JSmith
    	Account Domain:		CONTOSO
    	Logon ID:		0x30D695
    	Logon GUID:		{00000000-0000-0000-0000-000000000000}"

      519 |
      520 |       // Verify PII is anonymized
    > 521 |       expect(entry.message).not.toContain('JSmith');
          |                                 ^
      522 |       expect(entry.message).not.toContain('CONTOSO\\JSmith');
      523 |       expect(entry.message).not.toContain('SERVER-PROD-01');
      524 |     });

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:521:33)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Realistic Event Log Scenarios ΓÇ║ should anonymize service installation event with file paths

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "DOMAIN\\ServiceAccount"
    Received string:        "Service installed.
    Service Name: MyService
    Image Path: C:\\Program Files\\MyApp\\service.exe
    Service Type: user mode service
    Start Type: auto start
    Account: DOMAIN\\ServiceAccount"

      557 |
      558 |       // Verify service account is anonymized
    > 559 |       expect(entry.message).not.toContain('DOMAIN\\ServiceAccount');
          |                                 ^
      560 |       expect(entry.message).not.toContain('ServiceAccount');
      561 |     });
      562 |

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:559:33)

  ΓùÅ EventLog GraphQL Resolver - Security Tests for PII Anonymization ΓÇ║ Realistic Event Log Scenarios ΓÇ║ should anonymize network connection event with IPs

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "192.168.1.100"
    Received string:        "The Windows Filtering Platform has blocked a connection.
    Application Information:
    	Process ID:		1234
    	Application Path:	\\device\\harddiskvolume2\\windows\\notepad.exe
    Network Information:
    	Direction:		Inbound
    	Source Address:		192.168.1.100
    	Source Port:		50123
    	Destination Address:	10.0.0.5
    	Destination Port:	443"

      594 |
      595 |       // Verify IPs are anonymized
    > 596 |       expect(entry.message).not.toContain('192.168.1.100');
          |                                 ^
      597 |       expect(entry.message).not.toContain('10.0.0.5');
      598 |       expect(entry.message).not.toContain('WORKSTATION-01');
      599 |       expect(entry.message).not.toContain('DOMAIN\\NetworkUser');

      at Object.<anonymous> (src/services/eventlog/__tests__/anonymization.security.test.ts:596:33)

FAIL tests/integration.test.ts
  ΓùÅ Test suite failed to run

    tests/integration.test.ts:6:56 - error TS2307: Cannot find module '../../src/index' or its corresponding type declarations.

    6 import { initializeApp, shutdownApp, AppContext } from '../../src/index';
                                                             ~~~~~~~~~~~~~~~~~

FAIL src/__tests__/startup.test.ts (26.084 s)
  ΓùÅ Application Startup and Shutdown ΓÇ║ error handling ΓÇ║ should log startup information

    listen EADDRINUSE: address already in use :::3000

      213 |     return new Promise((resolve, reject) => {
      214 |       try {
    > 215 |         this.httpServer = this.app.listen(this.config.port, () => {
          |                                    ^
      216 |           this.logger.info('HTTP server started', {
      217 |             port: this.config.port,
      218 |             mode: this.config.nodeEnv,

      at app.listen (node_modules/express/lib/application.js:635:24)
      at src/server.ts:215:36
      at ServerImpl.start (src/server.ts:213:12)
      at initializeApp (src/index.ts:72:5)
      at Object.<anonymous> (src/__tests__/startup.test.ts:149:17)


Test Suites: 22 failed, 1 skipped, 15 passed, 37 of 38 total
Tests:       76 failed, 8 skipped, 534 passed, 618 total
Snapshots:   0 total
Time:        35.862 s
Ran all test suites.
